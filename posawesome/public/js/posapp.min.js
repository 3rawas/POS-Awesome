!function(){"use strict";var e=new Vue,t={data:function(){return{drawer:!0,mini:!0,item:0,items:[{text:"POS",icon:"mdi-point-of-sale"},{text:"Dashboard",icon:"mdi-view-dashboard"}],page:"",fav:!0,menu:!1,message:!1,hints:!0,menu_item:0,snack:!1,snackColor:"",snackText:"",company:"POS Awesome",company_img:"/assets/erpnext/images/erp-icon.svg"}},methods:{changePage:function(e){this.$emit("changePage",e)},go_to:function(){frappe.set_route("workspace","home"),location.reload()},close_shift_dialog:function(){e.$emit("open_closing_dialog")},show_mesage:function(e){this.snack=!0,this.snackColor=e.color,this.snackText=e.text}},created:function(){this.$nextTick(function(){var t=this;e.$on("show_mesage",function(e){t.show_mesage(e)}),e.$on("set_company",function(e){t.company=e.name,t.company_img=e.company_logo?e.company_logo:t.company_img})})}},n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",[n("v-app-bar",{staticClass:"elevation-2",attrs:{app:"",height:"40"}},[n("v-app-bar-nav-icon",{staticClass:"grey--text",on:{click:function(t){t.stopPropagation(),e.mini=!e.mini}}}),e._v(" "),n("v-toolbar-title",{staticClass:"text-uppercase indigo--text"},[n("span",{staticClass:"font-weight-light"},[e._v("pos")]),e._v(" "),n("span",[e._v("awesome")])]),e._v(" "),n("v-spacer"),e._v(" "),n("div",{staticClass:"text-center"},[n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"grey",dark:"",text:""}},"v-btn",i,!1),o),[e._v("Menu")])]}}])},[e._v(" "),n("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",tile:""}},[n("v-list",{attrs:{dense:""}},[n("v-list-item-group",{attrs:{color:"primary"},model:{value:e.menu_item,callback:function(t){e.menu_item=t},expression:"menu_item"}},[n("v-list-item",{on:{click:e.close_shift_dialog}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-folder-open")])],1),e._v(" "),n("v-list-item-content",[n("v-list-item-title",[e._v("Close Shift")])],1)],1)],1)],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"text-center"},[n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,i=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"grey",dark:"",text:""}},"v-btn",i,!1),o),[e._v("Pages")])]}}])},[e._v(" "),n("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",tile:""}},[n("v-list",{attrs:{dense:""}},[n("v-list-item-group",{attrs:{color:"primary"},model:{value:e.item,callback:function(t){e.item=t},expression:"item"}},e._l(e.items,function(t,o){return n("v-list-item",{key:t.text,on:{click:function(n){e.changePage(t.text),t=o}}},[n("v-list-item-icon",[n("v-icon",{domProps:{textContent:e._s(t.icon)}})],1),e._v(" "),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:e._s(t.text)}})],1)],1)}),1)],1)],1)],1)],1),e._v(" "),n("v-btn",{attrs:{text:"",color:"grey"},on:{click:e.go_to}},[n("span",{attrs:{right:""}},[e._v("Erpnext")])])],1),e._v(" "),n("v-navigation-drawer",{staticClass:"indigo margen-top",attrs:{"mini-variant":e.mini,app:""},on:{"update:miniVariant":function(t){e.mini=t},"update:mini-variant":function(t){e.mini=t}},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("v-list",{attrs:{dark:""}},[n("v-list-item",{staticClass:"px-2"},[n("v-list-item-avatar",[n("v-img",{attrs:{src:e.company_img}})],1),e._v(" "),n("v-list-item-title",[e._v(e._s(e.company))]),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.mini=!e.mini}}},[n("v-icon",[e._v("mdi-chevron-left")])],1)],1),e._v(" "),n("v-list-item-group",{attrs:{color:"white"},model:{value:e.item,callback:function(t){e.item=t},expression:"item"}},e._l(e.items,function(t){return n("v-list-item",{key:t.text,on:{click:function(n){return e.changePage(t.text)}}},[n("v-list-item-icon",[n("v-icon",{domProps:{textContent:e._s(t.icon)}})],1),e._v(" "),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:e._s(t.text)}})],1)],1)}),1)],1)],1),e._v(" "),n("v-snackbar",{attrs:{timeout:5e3,color:e.snackColor,top:"",right:""},model:{value:e.snack,callback:function(t){e.snack=t},expression:"snack"}},[e._v("\n    "+e._s(e.snackText)+"\n    ")])],1)};n._withStripped=!0;var o=function(e,t,n,o,i,s,a,c){var r,l=("function"==typeof n?n.options:n)||{};if(l.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/Navbar.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,i&&(l.functional=!0)),l._scopeId=o,t&&(r=function(e){t.call(this,a(e))}),void 0!==r)if(l.functional){var m=l.render;l.render=function(e,t){return r.call(t),m(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,r):[r]}return l}({render:n,staticRenderFns:[]},function(e){e&&e("data-v-43d5276c_0",{source:"\n.margen-top[data-v-43d5276c] {\n  margin-top: 0px;\n}\n",map:{version:3,sources:["/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/Navbar.vue"],names:[],mappings:";AAyKA;EACA,eAAA;AACA",file:"Navbar.vue",sourcesContent:['<template>\n  <nav>\n    <v-app-bar app height="40" class="elevation-2">\n      <v-app-bar-nav-icon\n        @click.stop="mini = !mini"\n        class="grey--text"\n      ></v-app-bar-nav-icon>\n      <v-toolbar-title class="text-uppercase indigo--text">\n        <span class="font-weight-light">pos</span>\n        <span>awesome</span>\n      </v-toolbar-title>\n\n      <v-spacer></v-spacer>\n\n      <div class="text-center">\n        <v-menu offset-y>\n          <template v-slot:activator="{ on, attrs }">\n            <v-btn color="grey" dark text v-bind="attrs" v-on="on">Menu</v-btn>\n          </template>\n          <v-card class="mx-auto" max-width="300" tile>\n            <v-list dense>\n              <v-list-item-group v-model="menu_item" color="primary">\n                <v-list-item @click="close_shift_dialog">\n                  <v-list-item-icon>\n                    <v-icon>mdi-folder-open</v-icon>\n                  </v-list-item-icon>\n                  <v-list-item-content>\n                    <v-list-item-title>Close Shift</v-list-item-title>\n                  </v-list-item-content>\n                </v-list-item>\n              </v-list-item-group>\n            </v-list>\n          </v-card>\n        </v-menu>\n      </div>\n\n      <div class="text-center">\n        <v-menu offset-y>\n          <template v-slot:activator="{ on, attrs }">\n            <v-btn color="grey" dark text v-bind="attrs" v-on="on">Pages</v-btn>\n          </template>\n          <v-card class="mx-auto" max-width="300" tile>\n            <v-list dense>\n              <v-list-item-group v-model="item" color="primary">\n                <v-list-item\n                  v-for="(item, index) in items"\n                  :key="item.text"\n                  @click="[changePage(item.text), (item = index)]"\n                >\n                  <v-list-item-icon>\n                    <v-icon v-text="item.icon"></v-icon>\n                  </v-list-item-icon>\n                  <v-list-item-content>\n                    <v-list-item-title v-text="item.text"></v-list-item-title>\n                  </v-list-item-content>\n                </v-list-item>\n              </v-list-item-group>\n            </v-list>\n          </v-card>\n        </v-menu>\n      </div>\n      <v-btn text color="grey" @click="go_to">\n        <span right>Erpnext</span>\n      </v-btn>\n    </v-app-bar>\n    <v-navigation-drawer\n      v-model="drawer"\n      :mini-variant.sync="mini"\n      app\n      class="indigo margen-top"\n    >\n      <v-list dark>\n        <v-list-item class="px-2">\n          <v-list-item-avatar>\n            <v-img :src="company_img"></v-img>\n          </v-list-item-avatar>\n\n          <v-list-item-title>{{ company }}</v-list-item-title>\n\n          <v-btn icon @click.stop="mini = !mini">\n            <v-icon>mdi-chevron-left</v-icon>\n          </v-btn>\n        </v-list-item>\n        \x3c!-- <MyPopup/> --\x3e\n        <v-list-item-group v-model="item" color="white">\n          <v-list-item\n            v-for="item in items"\n            :key="item.text"\n            @click="changePage(item.text)"\n          >\n            <v-list-item-icon>\n              <v-icon v-text="item.icon"></v-icon>\n            </v-list-item-icon>\n            <v-list-item-content>\n              <v-list-item-title v-text="item.text"></v-list-item-title>\n            </v-list-item-content>\n          </v-list-item>\n        </v-list-item-group>\n      </v-list>\n    </v-navigation-drawer>\n    <v-snackbar v-model="snack" :timeout="5000" :color="snackColor" top right >\n      {{ snackText }}\n      \x3c!-- <template v-slot:action="{ attrs }"> --\x3e\n        \x3c!-- <v-btn v-bind="attrs" text @click="snack = false">Close</v-btn> --\x3e\n      \x3c!-- </template> --\x3e\n    </v-snackbar>\n  </nav>\n</template>\n\n<script>\nimport { evntBus } from "../bus";\n\nexport default {\n  // components: {MyPopup},\n  data() {\n    return {\n      drawer: true,\n      mini: true,\n      item: 0,\n      items: [\n        { text: "POS", icon: "mdi-point-of-sale" },\n        { text: "Dashboard", icon: "mdi-view-dashboard" },\n      ],\n      page: "",\n      fav: true,\n      menu: false,\n      message: false,\n      hints: true,\n      menu_item: 0,\n      snack: false,\n      snackColor: "",\n      snackText: "",\n      company: "POS Awesome",\n      company_img: "/assets/erpnext/images/erp-icon.svg",\n    };\n  },\n  methods: {\n    changePage(key) {\n      this.$emit("changePage", key);\n    },\n    go_to() {\n      frappe.set_route("workspace", "home");\n      location.reload();\n    },\n    close_shift_dialog() {\n      evntBus.$emit("open_closing_dialog");\n    },\n    show_mesage(data) {\n      this.snack = true;\n      this.snackColor = data.color;\n      this.snackText = data.text;\n    },\n  },\n  created: function () {\n    this.$nextTick(function () {\n      evntBus.$on("show_mesage", (data) => {\n        this.show_mesage(data);\n      });\n      evntBus.$on("set_company", (data) => {\n        this.company = data.name;\n        this.company_img = data.company_logo ? data.company_logo :this.company_img ;\n      });\n    });\n    \n  },\n};\n<\/script>\n\n<style scoped>\n.margen-top {\n  margin-top: 0px;\n}\n</style>']},media:void 0})},t,"data-v-43d5276c",!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],n=e.styles||(e.styles={}),o="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,i){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var s=o?i.media||"default":e,a=n[s]||(n[s]={ids:[],parts:[],element:void 0});if(!a.ids.includes(e)){var c=i.source,r=a.ids.length;if(a.ids.push(e),o&&(a.element=a.element||document.querySelector("style[data-group="+s+"]")),!a.element){var l=a.element=document.createElement("style");l.type="text/css",i.media&&l.setAttribute("media",i.media),o&&(l.setAttribute("data-group",s),l.setAttribute("data-next-index","0")),t.appendChild(l)}if(o&&(r=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",r+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join("\n");else{var m=document.createTextNode(c),d=a.element.childNodes;d[r]&&a.element.removeChild(d[r]),d.length?a.element.insertBefore(m,d[r]):a.element.appendChild(m)}}}}}),i={data:function(){return{pos_profile:"",items_view:"card",item_group:"ALL",favourites_view:!1,loading:!1,items_group:["ALL"],items:[],item_search_brcode:"",search:"",first_search:"",itemsPerPage:1e3,items_headers:[{text:"Name",align:"start",sortable:!0,value:"item_name"},{text:"Rate",value:"rate",align:"start"},{text:"Currency",value:"currency",align:"start"},{text:"Available QTY",value:"actual_qty",align:"start"},{text:"UOM",value:"stock_uom",align:"start"}]}},watch:{filtred_items:function(e){this.update_items_details(e)}},methods:{get_items:function(){if(this.pos_profile){var e=this;this.loading=!0,localStorage.items_storage&&(e.items=JSON.parse(localStorage.getItem("items_storage")),e.loading=!1),frappe.call({method:"posawesome.posawesome.api.posapp.get_items",args:{pos_profile:e.pos_profile},callback:function(t){t.message&&(localStorage.setItem("items_storage",""),localStorage.setItem("items_storage",JSON.stringify(t.message)),e.$nextTick(function(){console.log("loadItmes"),e.items=JSON.parse(localStorage.getItem("items_storage")),e.loading=!1}))}})}else console.log("No POS Profile")},get_items_groups:function(){var e=this;if(this.pos_profile)if(this.pos_profile.item_groups.length>0)this.pos_profile.item_groups.forEach(function(t){"All Item Groups"!==t.item_group&&e.items_group.push(t.item_group)});else{var t=this;frappe.call({method:"posawesome.posawesome.api.posapp.get_items_groups",args:{},callback:function(e){e.message&&e.message.forEach(function(e){t.items_group.push(e.name)})}})}else console.log("No POS Profile")},add_item:function(t){e.$emit("add_item",t)},enter_event:function(){var e=this;if(this.filtred_items.length&&this.first_search){var t=this.get_item_qty(this.first_search),n=Object.assign({},this.filtred_items[0]);n.qty=flt(t),n.item_barcode.forEach(function(t){e.search==t.barcode&&(n.uom=t.posa_uom)}),this.add_item(n),this.search=null,this.first_search=null}},get_item_qty:function(e){var t=1;if(e.startsWith("221")){var n,o=e.substr(7,5);o.startsWith("0000")?n="0.00"+o.substr(4):o.startsWith("000")?n="0.0"+o.substr(3):o.startsWith("00")?n="0."+o.substr(2):o.startsWith("0")?n=o.substr(1,1)+"."+o.substr(2,o.length):o.startsWith("0")||(n=o.substr(0,2)+"."+o.substr(2,o.length)),t=n}return t},get_search:function(e){return e&&e.startsWith("221")?e.substr(0,7):e},esc_event:function(){this.search=null,this.first_search=null},update_items_details:function(e){frappe.call({method:"posawesome.posawesome.api.posapp.get_items_details",args:{pos_profile:this.pos_profile,items_data:e},callback:function(t){t.message&&e.forEach(function(e){var n=t.message.find(function(t){return t.item_code==e.item_code});e.actual_qty=n.actual_qty,e.serial_no_data=n.serial_no_data,e.batch_no_data=n.batch_no_data,e.item_uoms=n.item_uoms})}})},update_cur_items_details:function(){this.update_items_details(this.filtred_items)},scan_barcoud:function(){var t=this;onScan.attachTo(document,{keyCodeMapper:function(e){return event.stopImmediatePropagation(),onScan.decodeKeyEvent(e)},onScan:function(n){if(t.pos_profile.posa_use_server_for_searching){var o="";frappe.call({method:"posawesome.posawesome.api.posapp.get_items_from_barcode",args:{selling_price_list:t.pos_profile.selling_price_list,currency:t.pos_profile.currency,barcode:t.get_search(n)},async:!1,callback:function(e){e.message&&(o=e.message)}}),o?(t.first_search=n,t.item_search_brcode=o,t.enter_event(),t.item_search_brcode=null):(e.$emit("show_mesage",{text:"No Item has this barcode "+n,color:"error"}),frappe.utils.play_sound("error"))}else t.first_search=n,0==t.filtred_items.length?(e.$emit("show_mesage",{text:"No Item has this barcode "+n,color:"error"}),frappe.utils.play_sound("error")):t.enter_event()}})}},computed:{filtred_items:function(){var e=this;if(this.item_search_brcode)return[this.item_search_brcode];this.search=this.get_search(this.first_search);var t=[],n=[];return n="ALL"!=this.item_group?this.items.filter(function(t){return t.item_group.toLowerCase().includes(e.item_group.toLowerCase())}):this.items,!this.search||this.search.length<3?n.slice(0,100):(this.search&&0==(t=n.filter(function(t){for(var n=!1,o=0,i=t.item_barcode;o<i.length;o+=1){if(i[o].barcode==e.search){n=!0;break}}return n})).length&&0==(t=n.filter(function(t){return t.item_name.toLowerCase().includes(e.search.toLowerCase())})).length&&(t=n.filter(function(t){return t.item_code.toLowerCase().includes(e.search.toLowerCase())})),t.slice(0,100))}},created:function(){var t=this;this.$nextTick(function(){}),e.$on("register_pos_profile",function(e){t.pos_profile=e.pos_profile,t.get_items(),t.get_items_groups()}),e.$on("update_cur_items_details",function(){t.update_cur_items_details()})},mounted:function(){this.scan_barcoud()}},s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"selection mx-auto grey lighten-5",staticStyle:{"max-height":"77vh",height:"77vh"}},[n("v-progress-linear",{attrs:{active:e.loading,indeterminate:e.loading,absolute:"",top:"",color:"deep-purple accent-4"}}),e._v(" "),n("v-row",{staticClass:"items px-2 py-1"},[n("v-col",{staticClass:"pb-0 mb-2",attrs:{cols:"12"}},[n("v-text-field",{attrs:{dense:"",clearable:"",autofocus:"",outlined:"",color:"indigo",label:"Search Items",hint:"Search by item code, serial number, batch no or barcode","background-color":"white","hide-details":""},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enter_event(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.esc_event(t)}]},model:{value:e.first_search,callback:function(t){e.first_search=t},expression:"first_search"}})],1),e._v(" "),n("v-col",{staticClass:"pt-0 mt-0",attrs:{cols:"12"}},["card"==e.items_view?n("div",{staticClass:"items",attrs:{fluid:""}},[n("v-row",{staticClass:"overflow-y-auto",staticStyle:{"max-height":"67vh"},attrs:{dense:""}},e._l(e.filtred_items,function(t,o){return n("v-col",{key:o,attrs:{xl:"2",lg:"3",md:"6",sm:"6",cols:"6","min-height":"50"}},[n("v-card",{attrs:{hover:"hover"},on:{click:function(n){return e.add_item(t)}}},[n("v-img",{staticClass:"white--text align-end",attrs:{src:t.image||"https://lunawood.com/wp-content/uploads/2018/02/placeholder-image.png",gradient:"to bottom, rgba(0,0,0,.2), rgba(0,0,0,.7)",height:"100px"}},[n("v-card-text",{staticClass:"text-subtitle-2 px-1 pb-2",domProps:{textContent:e._s(t.item_name)}})],1),e._v(" "),n("v-card-text",{staticClass:"text--primary pa-1"},[n("div",{staticClass:"text-caption indigo--text accent-3"},[e._v("\n                    "+e._s(t.rate||0)+" "+e._s(t.currency||"")+"\n                  ")])])],1)],1)}),1)],1):e._e(),e._v(" "),"list"==e.items_view?n("div",{staticClass:"items",attrs:{fluid:""}},[n("div",{staticClass:"my-0 py-0 overflow-y-auto",staticStyle:{"max-height":"67vh"}},[[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.items_headers,items:e.filtred_items,"item-key":"item_code","items-per-page":e.itemsPerPage,"hide-default-footer":""},on:{"click:row":e.add_item}})]],2)]):e._e()])],1)],1),e._v(" "),n("v-card",{staticClass:"cards mb-0 mt-3 pa-2 grey lighten-5",staticStyle:{"max-height":"13vh",height:"13vh"}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("v-select",{attrs:{items:e.items_group,label:"Items Group",dense:"",outlined:"","hide-details":""},model:{value:e.item_group,callback:function(t){e.item_group=t},expression:"item_group"}})],1),e._v(" "),n("v-col",{staticClass:"mt-1",attrs:{cols:"8"}},[n("v-btn-toggle",{attrs:{color:"primary accent-3",group:"",dense:"",rounded:""},model:{value:e.items_view,callback:function(t){e.items_view=t},expression:"items_view"}},[n("v-btn",{attrs:{value:"card"}},[e._v("Card View")]),e._v(" "),n("v-btn",{attrs:{value:"list"}},[e._v("List View")])],1)],1),e._v(" "),n("v-col",{staticClass:"mt-1",attrs:{cols:"4"}},[n("v-btn-toggle",{attrs:{color:"success accent-3",group:"",dense:"",rounded:""},model:{value:e.favourites_view,callback:function(t){e.favourites_view=t},expression:"favourites_view"}},[n("v-btn",{attrs:{value:"True"}},[e._v("Favourites")])],1)],1)],1)],1)],1)};s._withStripped=!0;var a=function(e,t,n,o,i,s,a,c){var r,l=("function"==typeof n?n.options:n)||{};if(l.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/ItemsSelector.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,i&&(l.functional=!0)),l._scopeId=o,t&&(r=function(e){t.call(this,a(e))}),void 0!==r)if(l.functional){var m=l.render;l.render=function(e,t){return r.call(t),m(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,r):[r]}return l}({render:s,staticRenderFns:[]},function(e){e&&e("data-v-959fdb10_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",map:{version:3,sources:[],names:[],mappings:"",file:"ItemsSelector.vue"},media:void 0})},i,"data-v-959fdb10",!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],n=e.styles||(e.styles={}),o="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,i){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var s=o?i.media||"default":e,a=n[s]||(n[s]={ids:[],parts:[],element:void 0});if(!a.ids.includes(e)){var c=i.source,r=a.ids.length;if(a.ids.push(e),o&&(a.element=a.element||document.querySelector("style[data-group="+s+"]")),!a.element){var l=a.element=document.createElement("style");l.type="text/css",i.media&&l.setAttribute("media",i.media),o&&(l.setAttribute("data-group",s),l.setAttribute("data-next-index","0")),t.appendChild(l)}if(o&&(r=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",r+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join("\n");else{var m=document.createTextNode(c),d=a.element.childNodes;d[r]&&a.element.removeChild(d[r]),d.length?a.element.insertBefore(m,d[r]):a.element.appendChild(m)}}}}}),c={data:function(){return{pos_profile:"",customers:[],customer:""}},methods:{get_customer_names:function(){var e=this;localStorage.customer_storage&&(e.customers=JSON.parse(localStorage.getItem("customer_storage"))),frappe.call({method:"posawesome.posawesome.api.posapp.get_customer_names",args:{},callback:function(t){t.message&&(localStorage.setItem("customer_storage",""),localStorage.setItem("customer_storage",JSON.stringify(t.message)),e.$nextTick(function(){console.log("loadCustomers"),e.customers=JSON.parse(localStorage.getItem("customer_storage"))}))}})},new_customer:function(){e.$emit("open_new_customer")},customFilter:function(e,t,n){var o=e.name.toLowerCase(),i=e.tax_id?e.tax_id.toLowerCase():"",s=e.email_id?e.email_id.toLowerCase():"",a=e.mobile_no?e.mobile_no.toLowerCase():"",c=t.toLowerCase();return o.indexOf(c)>-1||i.indexOf(c)>-1||s.indexOf(c)>-1||a.indexOf(c)>-1}},computed:{},created:function(){this.$nextTick(function(){var t=this;e.$on("register_pos_profile",function(e){t.pos_profile=e,t.get_customer_names()}),e.$on("set_customer",function(e){t.customer=e}),e.$on("add_customer_to_list",function(e){t.customers.push(e)})})},watch:{customer:function(){e.$emit("update_customer",this.customer)}}},r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"items px-2 py-1"},[n("v-col",{staticClass:"pb-0 mb-2",attrs:{cols:"12"}},[n("v-autocomplete",{attrs:{dense:"",clearable:"",autofocus:"","auto-select-first":"",outlined:"",color:"indigo",label:"Customer",items:e.customers,"item-text":"name","background-color":"white","no-data-text":"Customer not found","hide-details":"",filter:e.customFilter},scopedSlots:e._u([{key:"item",fn:function(t){return[[n("v-list-item-content",[n("v-list-item-title",{staticClass:"indigo--text subtitle-1",domProps:{innerHTML:e._s(t.item.name)}}),e._v(" "),t.item.tax_id?n("v-list-item-subtitle",{domProps:{innerHTML:e._s("TAX ID: "+t.item.tax_id)}}):e._e(),e._v(" "),t.item.email_id?n("v-list-item-subtitle",{domProps:{innerHTML:e._s("Email: "+t.item.email_id)}}):e._e(),e._v(" "),t.item.mobile_no?n("v-list-item-subtitle",{domProps:{innerHTML:e._s("Mobile No: "+t.item.mobile_no)}}):e._e()],1)]]}},{key:"append-outer",fn:function(){return[n("v-slide-x-reverse-transition",{attrs:{mode:"out-in"}},[n("v-icon",{on:{click:e.new_customer}},[e._v("mdi-plus")])],1)]},proxy:!0}]),model:{value:e.customer,callback:function(t){e.customer=t},expression:"customer"}})],1)],1)};r._withStripped=!0;var l={data:function(){return{pos_profile:"",pos_opening_shift:"",invoice_doc:"",customer:"",customer_info:"",discount_amount:0,total_tax:0,total:0,items:[],itemsPerPage:1e3,expanded:[],singleExpand:!0,items_headers:[{text:"Name",align:"start",sortable:!0,value:"item_name"},{text:"QTY",value:"qty",align:"center"},{text:"UOM",value:"uom",align:"center"},{text:"Rate",value:"rate",align:"center"},{text:"Amount",value:"amount",align:"center"}]}},components:{Customer:function(e,t,n,o,i,s,a,c){var r=("function"==typeof n?n.options:n)||{};return r.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/Customer.vue",r.render||(r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._compiled=!0,i&&(r.functional=!0)),r._scopeId=o,r}({render:r,staticRenderFns:[]},0,c,void 0,!1)},computed:{total_qty:function(){this.close_payments();var e=0;return this.items.forEach(function(t){e+=t.qty}),flt(e).toFixed(2)},subtotal:function(){this.close_payments();var e=0;return this.items.forEach(function(t){e+=t.qty*t.rate}),e-=flt(this.discount_amount),flt(e).toFixed(2)},total_items_discount_amount:function(){var e=0;return this.items.forEach(function(t){e+=t.qty*t.discount_amount}),flt(e).toFixed(2)}},methods:{remove_item:function(e){var t=this.items.findIndex(function(t){return t===e});this.items.splice(t,1);var n=this.expanded.findIndex(function(t){return t===e});n>=0&&this.expanded.splice(n,1)},add_one:function(e){e.qty++,this.calc_sotck_gty(e,e.qty)},subtract_one:function(e){e.qty--,e.qty<=0&&this.remove_item(e),this.calc_sotck_gty(e,e.qty)},add_item:function(e){e.uom||(e.uom=e.stock_uom);var t=this.items.findIndex(function(t){return t.item_code===e.item_code&&t.uom===e.uom});if(-1===t){var n=this.get_new_item(e);this.items.unshift(n),this.update_item_detail(n)}else{var o=this.items[t];if(this.update_items_details([o]),o.has_batch_no)if(o.stock_qty<o.actual_batch_qty||!o.batch_no)o.qty+=e.qty,this.calc_sotck_gty(o,o.qty);else{var i=this.get_new_item(o);i.batch_no="",i.batch_no_expiry_date="",i.actual_batch_qty="",i.qty=e.qty||1,this.items.unshift(i)}else o.qty+=e.qty,this.calc_sotck_gty(o,o.qty)}},get_new_item:function(e){var t=Object.assign({},e);return e.qty||(e.qty=1),t.stock_qty=e.qty,t.discount_amount=0,t.discount_percentage=0,t.discount_amount_per_item=0,t.price_list_rate=e.rate,t.qty=e.qty,t.uom=e.uom?e.uom:e.stock_uom,t.actual_batch_qty="",t.conversion_factor=1,t.item_id=Date.now(),(t.has_batch_no||t.has_serial_no)&&this.expanded.push(t),t},cancel_invoice:function(){var t=this.get_invoice_doc();t.name&&this.pos_profile.posa_allow_delete&&frappe.call({method:"posawesome.posawesome.api.posapp.delete_invoice",args:{invoice:t.name},async:!0,callback:function(t){t.message&&e.$emit("show_mesage",{text:t.message,color:"warning"})}}),this.items=[],this.customer=this.pos_profile.customer,this.invoice_doc="",this.discount_amount=0},new_invoice:function(e){void 0===e&&(e={}),this.expanded=[];var t=this.get_invoice_doc();if(t.name?this.update_invoice(t):t.items.length&&this.save_draft_invoice(t),e.name){this.invoice_doc=e,this.items=e.items;var n=0;this.items.forEach(function(e){n++,e.item_id=Date.now()+n}),this.update_items_details(this.items),this.customer=e.customer,this.discount_amount=e.discount_amount,this.items.forEach(function(e){e.serial_no&&(e.serial_no_selected=[],e.serial_no.split("\n").forEach(function(t){t.length&&e.serial_no_selected.push(t)}),e.serial_no_selected_count=e.serial_no_selected.length)})}else this.items=[],this.customer=this.pos_profile.customer,this.invoice_doc="",this.discount_amount=0},save_draft_invoice:function(){var e=this,t=this.get_invoice_doc();return frappe.call({method:"posawesome.posawesome.api.posapp.save_draft_invoice",args:{data:t},async:!1,callback:function(t){t.message&&(e.invoice_doc=t.message)}}),this.invoice_doc},get_invoice_doc:function(){var e={};return this.invoice_doc.name&&(e=Object.assign({},this.invoice_doc)),e.doctype="Sales Invoice",e.is_pos=1,e.company=e.company||this.pos_profile.company,e.pos_profile=e.pos_profile||this.pos_profile.name,e.currency=e.currency||this.pos_profile.currency,e.naming_series=e.naming_series||this.pos_profile.naming_series,e.customer=this.customer,e.items=this.get_invoice_items(),e.total=this.subtotal,e.discount_amount=flt(this.discount_amount),e.posa_pos_opening_shift=this.pos_opening_shift.name,e.payments=this.get_payments(),e.taxes=[],e},get_invoice_items:function(){var e=[];return this.items.forEach(function(t){e.push({item_code:t.item_code,qty:t.qty,rate:t.rate,uom:t.uom,conversion_factor:t.conversion_factor,serial_no:t.serial_no,discount_percentage:t.discount_percentage,discount_amount:t.discount_amount,batch_no:t.batch_no})}),e},get_payments:function(){var e=[];return this.pos_profile.payments.forEach(function(t){e.push({amount:0,mode_of_payment:t.mode_of_payment,default:t.default,account:""})}),e},update_invoice:function(e){var t=this;return frappe.call({method:"posawesome.posawesome.api.posapp.update_invoice",args:{data:e},async:!1,callback:function(e){e.message&&(t.invoice_doc=e.message)}}),this.invoice_doc},proces_invoice:function(){var e=this.get_invoice_doc();return e.name?this.update_invoice(e):this.save_draft_invoice(e)},show_payment:function(){if(this.customer)if(this.items.length){if(this.validate_items()){e.$emit("show_payment","true");var t=this.proces_invoice();t.customer_info=this.customer_info,e.$emit("send_invoice_doc_payment",t)}}else e.$emit("show_mesage",{text:"There is no Items !",color:"error"});else e.$emit("show_mesage",{text:"There is no Customer !",color:"error"})},validate_items:function(){var t=this;return this.items.forEach(function(n){t.pos_profile.update_stock&&n.stock_qty>n.actual_qty&&e.$emit("show_mesage",{text:"The existing quantity of item "+n.item_name+" is not enough",color:"error"}),n.has_serial_no&&(n.serial_no_selected&&n.stock_qty==n.serial_no_selected.length||(e.$emit("show_mesage",{text:"Selcted serial numbers of item "+n.item_name+" is incorrect",color:"error"}),vlaue=!1)),n.has_batch_no&&n.stock_qty>n.actual_batch_qty&&e.$emit("show_mesage",{text:"The existing batch quantity of item "+n.item_name+" is not enough",color:"error"})}),vlaue},get_draft_invoices:function(){frappe.call({method:"posawesome.posawesome.api.posapp.get_draft_invoices",args:{pos_opening_shift:this.pos_opening_shift.name},async:!1,callback:function(t){t.message&&e.$emit("open_drafts",t.message)}})},close_payments:function(){e.$emit("show_payment","false")},update_items_details:function(e){if(!(!e.length>0)){frappe.call({method:"posawesome.posawesome.api.posapp.get_items_details",args:{pos_profile:this.pos_profile,items_data:e},callback:function(t){t.message&&e.forEach(function(e){var n=t.message.find(function(t){return t.item_id==e.item_id});e.actual_qty=n.actual_qty,e.serial_no_data=n.serial_no_data,e.batch_no_data=n.batch_no_data,e.item_uoms=n.item_uoms,e.has_batch_no=n.has_batch_no,e.has_serial_no=n.has_serial_no})}})}},update_item_detail:function(e){var t=this;frappe.call({method:"posawesome.posawesome.api.posapp.get_item_detail",args:{doc:this.get_invoice_doc(),data:{item_code:e.item_code,customer:this.customer,doctype:"Sales Invoice",name:"New Sales Invoice 1",company:this.pos_profile.company,conversion_rate:1,qty:e.qty,price_list_rate:e.price_list_rate,child_docname:"New Sales Invoice Item 1",cost_center:this.pos_profile.cost_center,currency:this.pos_profile.currency,pos_profile:this.pos_profile.name,price_list:this.pos_profile.selling_price_list,uom:e.uom,tax_category:"",transaction_type:"selling",update_stock:this.pos_profile.update_stock}},callback:function(n){if(n.message){var o=n.message;o.has_pricing_rule&&(e.discount_amount_on_rate=o.discount_amount_on_rate,e.discount_percentage=o.discount_percentage,e.discount_percentage_on_rate=o.discount_percentage_on_rate,e.discount_amount=o.discount_amount||0),e.price_list_rate=o.price_list_rate,e.has_pricing_rule=o.has_pricing_rule,e.last_purchase_rate=o.last_purchase_rate,e.price_or_product_discount=o.price_or_product_discount,e.pricing_rule_for=o.pricing_rule_for,e.pricing_rules=o.pricing_rules,e.projected_qty=o.projected_qty,e.reserved_qty=o.reserved_qty,e.conversion_factor=o.conversion_factor,e.stock_qty=o.stock_qty,e.stock_uom=o.stock_uom,e.has_serial_no=o.has_serial_no,e.has_batch_no=o.has_batch_no,t.calc_item_price(e)}}})},fetch_customer_details:function(){var e=this;return this.customer?new Promise(function(t){frappe.db.get_value("Customer",e.customer,["email_id","mobile_no","image","loyalty_program"]).then(function(n){var o=n.message,i=o.loyalty_program;i?frappe.call({method:"erpnext.accounts.doctype.loyalty_program.loyalty_program.get_loyalty_program_details_with_points",args:{customer:e.customer,loyalty_program:i,silent:!0},callback:function(n){var i=n.message,s=i.loyalty_points,a=i.conversion_factor;n.exc||(e.customer_info=Object.assign({},o,{customer:e.customer,loyalty_points:s,conversion_factor:a}),t())}}):(e.customer_info=Object.assign({},o,{customer:e.customer}),t())})}):new Promise(function(t){e.customer_info={},t()})},calc_prices:function(e,t,n){"rate"===event.target.id?(e.discount_percentage=0,t<e.price_list_rate?e.discount_amount=(flt(e.price_list_rate)-flt(t)).toFixed(2):t<0?(e.rate=e.price_list_rate,e.discount_amount=0):t>e.price_list_rate&&(e.discount_amount=0)):"discount_amount"===event.target.id?t<0?(e.discount_amount=0,e.discount_percentage=0):(e.rate=flt(e.price_list_rate)-flt(t),e.discount_percentage=0):"discount_percentage"===event.target.id&&(t<0?(e.discount_amount=0,e.discount_percentage=0):(e.rate=(flt(e.price_list_rate)-flt(e.price_list_rate)*flt(t)/100).toFixed(2),e.discount_amount=(flt(e.price_list_rate)-flt(e.rate)).toFixed(2)))},calc_item_price:function(e){e.has_pricing_rule||e.price_list_rate&&(e.rate=e.price_list_rate),e.discount_percentage?(e.rate=flt(e.price_list_rate)-flt(e.price_list_rate)*flt(e.discount_percentage)/100,e.discount_amount=(flt(e.price_list_rate)-flt(e.rate)).toFixed(2)):e.discount_amount?e.rate=(flt(e.price_list_rate)-flt(e.discount_amount)).toFixed(2):"Rate"===e.pricing_rule_for&&(e.rate=e.price_list_rate)},calc_uom:function(e,t){var n=e.item_uoms.find(function(e){return e.uom==t});e.conversion_factor=n.conversion_factor,e.has_pricing_rule||(e.discount_amount=0,e.discount_percentage=0),this.update_item_detail(e)},calc_sotck_gty:function(e,t){e.stock_qty=e.conversion_factor*t},set_serial_no:function(t){t.serial_no="",t.serial_no_selected.forEach(function(e){t.serial_no+=e+"\n"}),t.serial_no_selected_count=t.serial_no_selected.length,t.serial_no_selected_count!=t.stock_qty&&e.$emit("show_mesage",{text:"Selected Serial No QTY is "+t.serial_no_selected_count+" it should be "+t.stock_qty,color:"warning"})},set_batch_qty:function(e,t){var n=e.batch_no_data.find(function(e){return e.batch_no==t});e.actual_batch_qty=n.batch_qty,e.batch_no_expiry_date=n.expiry_date},set_customer_info:function(t,n){var o=this;frappe.call({method:"erpnext.selling.page.point_of_sale.point_of_sale.set_customer_info",args:{fieldname:t,customer:this.customer_info.customer,value:n},callback:function(i){i.exc||(o.customer_info[t]=n,e.$emit("show_mesage",{text:"Customer contact updated successfully.",color:"success"}),frappe.utils.play_sound("submit"))}})}},created:function(){var t=this;this.$nextTick(function(){}),e.$on("register_pos_profile",function(e){t.pos_profile=e.pos_profile,t.customer=e.pos_profile.customer,t.pos_opening_shift=e.pos_opening_shift}),e.$on("add_item",function(e){t.add_item(e)}),e.$on("update_customer",function(e){t.customer=e}),e.$on("new_invoice",function(){t.invoice_doc="",t.cancel_invoice()}),e.$on("load_invoice",function(e){t.new_invoice(e)})},mounted:function(){},watch:{customer:function(){this.close_payments(),e.$emit("set_customer",this.customer),this.fetch_customer_details()},expanded:function(e){this.update_items_details(e),e.length>0&&this.update_item_detail(e[0])}}},m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"cards my-0 py-0 grey lighten-5",staticStyle:{"max-height":"65vh",height:"65vh"}},[n("Customer"),e._v(" "),n("div",{staticClass:"my-0 py-0 overflow-y-auto",staticStyle:{"max-height":"55vh"}},[[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.items_headers,items:e.items,"single-expand":e.singleExpand,expanded:e.expanded,"show-expand":"","item-key":"item_id","items-per-page":e.itemsPerPage,"hide-default-footer":""},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.amount",fn:function(t){var n=t.item;return[e._v(e._s((n.qty*n.rate).toFixed(2)))]}},{key:"expanded-item",fn:function(t){var o=t.headers,i=t.item;return[n("td",{staticClass:"ma-0 pa-0",attrs:{colspan:o.length}},[n("v-row",{staticClass:"ma-0 pa-0"},[n("v-col",{attrs:{cols:"1"}},[n("v-btn",{attrs:{icon:"",color:"red"},on:{click:function(t){return t.stopPropagation(),e.remove_item(i)}}},[n("v-icon",[e._v("mdi-delete")])],1)],1),e._v(" "),n("v-spacer"),e._v(" "),n("v-col",{attrs:{cols:"1"}},[n("v-btn",{attrs:{icon:"",color:"indigo lighten-1"},on:{click:function(t){return t.stopPropagation(),e.subtract_one(i)}}},[n("v-icon",[e._v("mdi-minus-circle-outline")])],1)],1),e._v(" "),n("v-col",{attrs:{cols:"1"}},[n("v-btn",{attrs:{icon:"",color:"indigo lighten-1"},on:{click:function(t){return t.stopPropagation(),e.add_one(i)}}},[n("v-icon",[e._v("mdi-plus-circle-outline")])],1)],1)],1),e._v(" "),n("v-row",{staticClass:"ma-0 pa-0"},[n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Item Code","background-color":"white","hide-details":"",disabled:""},model:{value:i.item_code,callback:function(t){e.$set(i,"item_code",t)},expression:"item.item_code"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"QTY","background-color":"white","hide-details":"",type:"number"},on:{change:function(t){return e.calc_sotck_gty(i,t)}},model:{value:i.qty,callback:function(t){e.$set(i,"qty",e._n(t))},expression:"item.qty"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-select",{attrs:{dense:"","background-color":"white",label:"UOM",items:i.item_uoms,outlined:"","item-text":"uom","item-value":"uom","hide-details":""},on:{change:function(t){return e.calc_uom(i,t)}},model:{value:i.uom,callback:function(t){e.$set(i,"uom",t)},expression:"item.uom"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Rate","background-color":"white","hide-details":"",type:"number",prefix:e.invoice_doc.currency,id:"rate",disabled:!(!i.pricing_rules&&e.pos_profile.posa_allow_user_to_edit_rate)},on:{change:function(t){return e.calc_prices(i,t)}},model:{value:i.rate,callback:function(t){e.$set(i,"rate",e._n(t))},expression:"item.rate"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Discount Percentage","background-color":"white","hide-details":"",type:"number",id:"discount_percentage",disabled:!(!i.pricing_rules&&e.pos_profile.posa_allow_user_to_edit_item_discount)},on:{change:function(t){return e.calc_prices(i,t)}},model:{value:i.discount_percentage,callback:function(t){e.$set(i,"discount_percentage",e._n(t))},expression:"item.discount_percentage"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Discount Amount","background-color":"white","hide-details":"",type:"number",prefix:e.invoice_doc.currency,id:"discount_amount",disabled:!(!i.pricing_rules&&e.pos_profile.posa_allow_user_to_edit_item_discount)},on:{change:function(t){return e.calc_prices(i,t)}},model:{value:i.discount_amount,callback:function(t){e.$set(i,"discount_amount",e._n(t))},expression:"item.discount_amount"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Price list Rate","background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency},model:{value:i.price_list_rate,callback:function(t){e.$set(i,"price_list_rate",t)},expression:"item.price_list_rate"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Available QTY","background-color":"white","hide-details":"",type:"number",disabled:""},model:{value:i.actual_qty,callback:function(t){e.$set(i,"actual_qty",t)},expression:"item.actual_qty"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Group","background-color":"white","hide-details":"",disabled:""},model:{value:i.item_group,callback:function(t){e.$set(i,"item_group",t)},expression:"item.item_group"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Stock QTY","background-color":"white","hide-details":"",type:"number",disabled:""},model:{value:i.stock_qty,callback:function(t){e.$set(i,"stock_qty",t)},expression:"item.stock_qty"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Stock UOM","background-color":"white","hide-details":"",disabled:""},model:{value:i.stock_uom,callback:function(t){e.$set(i,"stock_uom",t)},expression:"item.stock_uom"}})],1),e._v(" "),1==i.has_serial_no||i.serial_no?n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Serial No QTY","background-color":"white","hide-details":"",type:"number",disabled:""},model:{value:i.serial_no_selected_count,callback:function(t){e.$set(i,"serial_no_selected_count",t)},expression:"item.serial_no_selected_count"}})],1):e._e(),e._v(" "),1==i.has_serial_no||i.serial_no?n("v-col",{attrs:{cols:"12"}},[n("v-autocomplete",{attrs:{items:i.serial_no_data,"item-text":"serial_no",outlined:"",dense:"",chips:"",color:"indigo","small-chips":"",label:"Serial No",multiple:""},on:{change:function(t){return e.set_serial_no(i)}},model:{value:i.serial_no_selected,callback:function(t){e.$set(i,"serial_no_selected",t)},expression:"item.serial_no_selected"}})],1):e._e(),e._v(" "),1==i.has_batch_no||i.batch_no?n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Batch No Available QTY","background-color":"white","hide-details":"",type:"number",disabled:""},model:{value:i.actual_batch_qty,callback:function(t){e.$set(i,"actual_batch_qty",t)},expression:"item.actual_batch_qty"}})],1):e._e(),e._v(" "),1==i.has_batch_no||i.batch_no?n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Batch No Expiry Date","background-color":"white","hide-details":"",disabled:""},model:{value:i.batch_no_expiry_date,callback:function(t){e.$set(i,"batch_no_expiry_date",t)},expression:"item.batch_no_expiry_date"}})],1):e._e(),e._v(" "),1==i.has_batch_no||i.batch_no?n("v-col",{attrs:{cols:"8"}},[n("v-autocomplete",{attrs:{items:i.batch_no_data,"item-text":"batch_no",outlined:"",dense:"",color:"indigo",label:"Bacth No"},on:{change:function(t){return e.set_batch_qty(i,t)}},scopedSlots:e._u([{key:"item",fn:function(t){return[[n("v-list-item-content",[n("v-list-item-title",{domProps:{innerHTML:e._s(t.item.batch_no)}}),e._v(" "),n("v-list-item-subtitle",{domProps:{innerHTML:e._s("Available QTY  '"+t.item.batch_qty+"' - Expiry Date "+t.item.expiry_date)}})],1)]]}}],null,!0),model:{value:i.batch_no,callback:function(t){e.$set(i,"batch_no",t)},expression:"item.batch_no"}})],1):e._e()],1)],1)]}}])})]],2)],1),e._v(" "),n("v-row",[n("v-col",{staticClass:"pt-0 pr-0",attrs:{cols:"8"}},[n("v-card",{staticClass:"cards mb-0 mt-3 py-0 grey lighten-5",staticStyle:{"max-height":"25vh",height:"25vh"}},[n("v-row",{staticClass:"pa-1 pt-2",staticStyle:{height:"100%"},attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"6","no-gutters":""}},[n("v-row",{staticClass:"ma-1 pa-0",staticStyle:{height:"100%"},attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Total Qty",outlined:"",dense:"",readonly:"","hide-details":"",type:"number"},model:{value:e.total_qty,callback:function(t){e.total_qty=t},expression:"total_qty"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Items Discounts",outlined:"",dense:"",readonly:"","hide-details":"",type:"number",prefix:e.pos_profile.currency},model:{value:e.total_items_discount_amount,callback:function(t){e.total_items_discount_amount=t},expression:"total_items_discount_amount"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"ِAdditional Discount",outlined:"",dense:"","hide-details":"",type:"number",prefix:e.pos_profile.currency,disabled:!e.pos_profile.posa_allow_user_to_edit_additional_discount},model:{value:e.discount_amount,callback:function(t){e.discount_amount=t},expression:"discount_amount"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{staticClass:"text--red",attrs:{label:"Total",outlined:"",dense:"",readonly:"","hide-details":"",type:"number",prefix:e.pos_profile.currency},model:{value:e.subtotal,callback:function(t){e.subtotal=t},expression:"subtotal"}})],1)],1)],1),e._v(" "),n("v-col",{attrs:{"no-gutters":"",cols:"6"}},[n("v-row",{staticClass:"ma-1 pa-0",staticStyle:{height:"100%"},attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Email",outlined:"",dense:"","hide-details":""},on:{change:function(t){return e.set_customer_info("email_id",t)}},model:{value:e.customer_info.email_id,callback:function(t){e.$set(e.customer_info,"email_id",t)},expression:"customer_info.email_id"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"ِPhone Number",outlined:"",dense:"","hide-details":"",type:"number"},on:{change:function(t){return e.set_customer_info("mobile_no",t)}},model:{value:e.customer_info.mobile_no,callback:function(t){e.$set(e.customer_info,"mobile_no",t)},expression:"customer_info.mobile_no"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Loyalty Program",outlined:"",dense:"",disabled:"","hide-details":""},model:{value:e.customer_info.loyalty_program,callback:function(t){e.$set(e.customer_info,"loyalty_program",t)},expression:"customer_info.loyalty_program"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Loyalty Points",outlined:"",dense:"",disabled:"","hide-details":"",type:"number"},model:{value:e.customer_info.loyalty_points,callback:function(t){e.$set(e.customer_info,"loyalty_points",t)},expression:"customer_info.loyalty_points"}})],1)],1)],1)],1)],1)],1),e._v(" "),n("v-col",{staticClass:"pt-0 pr-3",attrs:{cols:"4"}},[n("v-card",{staticClass:"cards mb-0 mt-3 py-0",staticStyle:{"max-height":"25vh",height:"25vh"},attrs:{flat:""}},[n("v-row",{staticStyle:{height:"52%"},attrs:{align:"start"}},[n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"pa-0",attrs:{block:"",large:"",color:"warning",dark:""},on:{click:e.get_draft_invoices}},[e._v("Get Hold Invoice")])],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-btn",{staticClass:"pa-0",attrs:{block:"",large:"",color:"error",dark:""},on:{click:e.cancel_invoice}},[e._v("Cancel")])],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-btn",{staticClass:"pa-0",attrs:{block:"",large:"",color:"success",dark:""},on:{click:e.new_invoice}},[e._v("New")])],1)],1),e._v(" "),n("v-row",{staticStyle:{height:"54%"},attrs:{align:"end"}},[n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"pa-0",attrs:{block:"",large:"",color:"primary",dark:""},on:{click:e.show_payment}},[e._v("PAY")])],1)],1)],1)],1)],1)],1)};m._withStripped=!0;var d=function(e,t,n,o,i,s,a,c){var r,l=("function"==typeof n?n.options:n)||{};if(l.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/Invoice.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,i&&(l.functional=!0)),l._scopeId=o,t&&(r=function(e){t.call(this,a(e))}),void 0!==r)if(l.functional){var m=l.render;l.render=function(e,t){return r.call(t),m(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,r):[r]}return l}({render:m,staticRenderFns:[]},function(e){e&&e("data-v-0552fcbb_0",{source:"\n.border_line_bottom[data-v-0552fcbb] {\n  border-bottom: 1px solid lightgray;\n}\n",map:{version:3,sources:["/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/Invoice.vue"],names:[],mappings:";AAgmCA;EACA,kCAAA;AACA",file:"Invoice.vue",sourcesContent:['<template>\n  <div>\n    <v-card\n      style="max-height: 65vh; height: 65vh"\n      class="cards my-0 py-0 grey lighten-5"\n    >\n      <Customer></Customer>\n      <div class="my-0 py-0 overflow-y-auto" style="max-height: 55vh">\n        <template @mouseover="style = \'cursor: pointer\'">\n          <v-data-table\n            :headers="items_headers"\n            :items="items"\n            :single-expand="singleExpand"\n            :expanded.sync="expanded"\n            show-expand\n            item-key="item_id"\n            class="elevation-1"\n            :items-per-page="itemsPerPage"\n            hide-default-footer\n          >\n            <template v-slot:item.amount="{ item }">{{\n              (item.qty * item.rate).toFixed(2)\n            }}</template>\n\n            <template v-slot:expanded-item="{ headers, item }">\n              <td :colspan="headers.length" class="ma-0 pa-0">\n                <v-row class="ma-0 pa-0">\n                  <v-col cols="1">\n                    <v-btn icon color="red" @click.stop="remove_item(item)">\n                      <v-icon>mdi-delete</v-icon>\n                    </v-btn>\n                  </v-col>\n                  <v-spacer></v-spacer>\n                  <v-col cols="1">\n                    <v-btn\n                      icon\n                      color="indigo lighten-1"\n                      @click.stop="subtract_one(item)"\n                    >\n                      <v-icon>mdi-minus-circle-outline</v-icon>\n                    </v-btn>\n                  </v-col>\n                  <v-col cols="1">\n                    <v-btn\n                      icon\n                      color="indigo lighten-1"\n                      @click.stop="add_one(item)"\n                    >\n                      <v-icon>mdi-plus-circle-outline</v-icon>\n                    </v-btn>\n                  </v-col>\n                </v-row>\n                <v-row class="ma-0 pa-0">\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Item Code"\n                      background-color="white"\n                      hide-details\n                      v-model="item.item_code"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="QTY"\n                      background-color="white"\n                      hide-details\n                      v-model.number="item.qty"\n                      type="number"\n                      @change="calc_sotck_gty(item, $event)"\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-select\n                      dense\n                      background-color="white"\n                      label="UOM"\n                      v-model="item.uom"\n                      :items="item.item_uoms"\n                      outlined\n                      item-text="uom"\n                      item-value="uom"\n                      hide-details\n                      @change="calc_uom(item, $event)"\n                    >\n                    </v-select>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Rate"\n                      background-color="white"\n                      hide-details\n                      v-model.number="item.rate"\n                      type="number"\n                      :prefix="invoice_doc.currency"\n                      @change="calc_prices(item, $event)"\n                      id="rate"\n                      :disabled="item.pricing_rules || !pos_profile.posa_allow_user_to_edit_rate ? true : false"\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Discount Percentage"\n                      background-color="white"\n                      hide-details\n                      v-model.number="item.discount_percentage"\n                      type="number"\n                      @change="calc_prices(item, $event)"\n                      id="discount_percentage"\n                      :disabled="item.pricing_rules || !pos_profile.posa_allow_user_to_edit_item_discount ? true : false"\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Discount Amount"\n                      background-color="white"\n                      hide-details\n                      v-model.number="item.discount_amount"\n                      type="number"\n                      :prefix="invoice_doc.currency"\n                      @change="calc_prices(item, $event)"\n                      id="discount_amount"\n                      :disabled="item.pricing_rules || !pos_profile.posa_allow_user_to_edit_item_discount ? true : false"\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Price list Rate"\n                      background-color="white"\n                      hide-details\n                      v-model="item.price_list_rate"\n                      type="number"\n                      disabled\n                      :prefix="invoice_doc.currency"\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Available QTY"\n                      background-color="white"\n                      hide-details\n                      v-model="item.actual_qty"\n                      type="number"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Group"\n                      background-color="white"\n                      hide-details\n                      v-model="item.item_group"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Stock QTY"\n                      background-color="white"\n                      hide-details\n                      v-model="item.stock_qty"\n                      type="number"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col cols="4">\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Stock UOM"\n                      background-color="white"\n                      hide-details\n                      v-model="item.stock_uom"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col\n                    cols="4"\n                    v-if="item.has_serial_no == 1 || item.serial_no"\n                  >\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Serial No QTY"\n                      background-color="white"\n                      hide-details\n                      v-model="item.serial_no_selected_count"\n                      type="number"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col\n                    cols="12"\n                    v-if="item.has_serial_no == 1 || item.serial_no"\n                  >\n                    <v-autocomplete\n                      v-model="item.serial_no_selected"\n                      :items="item.serial_no_data"\n                      item-text="serial_no"\n                      outlined\n                      dense\n                      chips\n                      color="indigo"\n                      small-chips\n                      label="Serial No"\n                      multiple\n                      @change="set_serial_no(item)"\n                    ></v-autocomplete>\n                  </v-col>\n                  <v-col\n                    cols="4"\n                    v-if="item.has_batch_no == 1 || item.batch_no"\n                  >\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Batch No Available QTY"\n                      background-color="white"\n                      hide-details\n                      v-model="item.actual_batch_qty"\n                      type="number"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col\n                    cols="4"\n                    v-if="item.has_batch_no == 1 || item.batch_no"\n                  >\n                    <v-text-field\n                      dense\n                      outlined\n                      color="indigo"\n                      label="Batch No Expiry Date"\n                      background-color="white"\n                      hide-details\n                      v-model="item.batch_no_expiry_date"\n                      disabled\n                    ></v-text-field>\n                  </v-col>\n                  <v-col\n                    cols="8"\n                    v-if="item.has_batch_no == 1 || item.batch_no"\n                  >\n                    <v-autocomplete\n                      v-model="item.batch_no"\n                      :items="item.batch_no_data"\n                      item-text="batch_no"\n                      outlined\n                      dense\n                      color="indigo"\n                      label="Bacth No"\n                      @change="set_batch_qty(item, $event)"\n                    >\n                      <template v-slot:item="data">\n                        <template>\n                          <v-list-item-content>\n                            <v-list-item-title\n                              v-html="data.item.batch_no"\n                            ></v-list-item-title>\n                            <v-list-item-subtitle\n                              v-html="\n                                `Available QTY  \'${data.item.batch_qty}\' - Expiry Date ${data.item.expiry_date}`\n                              "\n                            ></v-list-item-subtitle>\n                          </v-list-item-content>\n                        </template>\n                      </template>\n                    </v-autocomplete>\n                  </v-col>\n                </v-row>\n              </td>\n            </template>\n          </v-data-table>\n        </template>\n      </div>\n    </v-card>\n    <v-row>\n      <v-col class="pt-0 pr-0" cols="8">\n        <v-card\n          style="max-height: 25vh; height: 25vh"\n          class="cards mb-0 mt-3 py-0 grey lighten-5"\n        >\n          <v-row no-gutters class="pa-1 pt-2" style="height: 100%">\n            <v-col cols="6" no-gutters>\n              <v-row no-gutters class="ma-1 pa-0" style="height: 100%">\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="total_qty"\n                    label="Total Qty"\n                    outlined\n                    dense\n                    readonly\n                    hide-details\n                    type="number"\n                  ></v-text-field>\n                </v-col>\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="total_items_discount_amount"\n                    label="Items Discounts"\n                    outlined\n                    dense\n                    readonly\n                    hide-details\n                    type="number"\n                    :prefix="pos_profile.currency"\n                  ></v-text-field>\n                </v-col>\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="discount_amount"\n                    label="ِAdditional Discount"\n                    outlined\n                    dense\n                    hide-details\n                    type="number"\n                    :prefix="pos_profile.currency"\n                    :disabled="!pos_profile.posa_allow_user_to_edit_additional_discount ? true : false"\n                  ></v-text-field>\n                </v-col>\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="subtotal"\n                    label="Total"\n                    outlined\n                    dense\n                    readonly\n                    hide-details\n                    class="text--red"\n                    type="number"\n                    :prefix="pos_profile.currency"\n                  ></v-text-field>\n                </v-col>\n              </v-row>\n            </v-col>\n            <v-col no-gutters cols="6">\n              <v-row no-gutters class="ma-1 pa-0" style="height: 100%">\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="customer_info.email_id"\n                    label="Email"\n                    outlined\n                    dense\n                    @change="set_customer_info(\'email_id\', $event)"\n                    hide-details\n                  ></v-text-field>\n                </v-col>\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="customer_info.mobile_no"\n                    label="ِPhone Number"\n                    outlined\n                    dense\n                    hide-details\n                    @change="set_customer_info(\'mobile_no\', $event)"\n                    type="number"\n                  ></v-text-field>\n                </v-col>\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="customer_info.loyalty_program"\n                    label="Loyalty Program"\n                    outlined\n                    dense\n                    disabled\n                    hide-details\n                  ></v-text-field>\n                </v-col>\n                <v-col cols="12">\n                  <v-text-field\n                    v-model="customer_info.loyalty_points"\n                    label="Loyalty Points"\n                    outlined\n                    dense\n                    disabled\n                    hide-details\n                    type="number"\n                  ></v-text-field>\n                </v-col>\n              </v-row>\n            </v-col>\n          </v-row>\n        </v-card>\n      </v-col>\n      <v-col class="pt-0 pr-3" cols="4">\n        <v-card\n          flat\n          style="max-height: 25vh; height: 25vh"\n          class="cards mb-0 mt-3 py-0"\n        >\n          <v-row align="start" style="height: 52%">\n            <v-col cols="12">\n              <v-btn\n                block\n                class="pa-0"\n                large\n                color="warning"\n                dark\n                @click="get_draft_invoices"\n                >Get Hold Invoice</v-btn\n              >\n            </v-col>\n            <v-col cols="6">\n              <v-btn\n                block\n                class="pa-0"\n                large\n                color="error"\n                dark\n                @click="cancel_invoice"\n                >Cancel</v-btn\n              >\n            </v-col>\n            <v-col cols="6">\n              <v-btn\n                block\n                class="pa-0"\n                large\n                color="success"\n                dark\n                @click="new_invoice"\n                >New</v-btn\n              >\n            </v-col>\n          </v-row>\n          <v-row align="end" style="height: 54%">\n            <v-col cols="12">\n              <v-btn\n                block\n                class="pa-0"\n                large\n                color="primary"\n                @click="show_payment"\n                dark\n                >PAY</v-btn\n              >\n            </v-col>\n          </v-row>\n        </v-card>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n<script>\nimport { evntBus } from "../../bus";\nimport Customer from "./Customer.vue";\nexport default {\n  // props: ["pos_profile"],\n  data() {\n    return {\n      pos_profile: "",\n      pos_opening_shift: "",\n      invoice_doc: "",\n      customer: "",\n      customer_info: "",\n      discount_amount: 0,\n      total_tax: 0,\n      total: 0,\n      items: [],\n      itemsPerPage: 1000,\n      expanded: [],\n      singleExpand: true,\n      items_headers: [\n        {\n          text: "Name",\n          align: "start",\n          sortable: true,\n          value: "item_name",\n        },\n        { text: "QTY", value: "qty", align: "center" },\n        { text: "UOM", value: "uom", align: "center" },\n        { text: "Rate", value: "rate", align: "center" },\n        { text: "Amount", value: "amount", align: "center" },\n      ],\n    };\n  },\n  components: {\n    Customer,\n  },\n  computed: {\n    total_qty() {\n      this.close_payments();\n      let qty = 0;\n      this.items.forEach((item) => {\n        qty += item.qty;\n      });\n      return flt(qty).toFixed(2);\n    },\n    subtotal() {\n      this.close_payments();\n      let sum = 0;\n      this.items.forEach((item) => {\n        sum += item.qty * item.rate;\n      });\n      sum -= flt(this.discount_amount);\n      return flt(sum).toFixed(2);\n    },\n    total_items_discount_amount() {\n      let sum = 0;\n      this.items.forEach((item) => {\n        sum += item.qty * item.discount_amount;\n      });\n      return flt(sum).toFixed(2);\n    },\n  },\n  methods: {\n    remove_item(item) {\n      const index = this.items.findIndex((el) => el === item);\n      this.items.splice(index, 1);\n      const idx = this.expanded.findIndex((el) => el === item);\n      if (idx >= 0) {\n        this.expanded.splice(idx, 1);\n      }\n    },\n    add_one(item) {\n      item.qty++;\n      this.calc_sotck_gty(item, item.qty);\n      // this.$forceUpdate();\n    },\n    subtract_one(item) {\n      item.qty--;\n      if (item.qty <= 0) {\n        this.remove_item(item);\n      }\n      this.calc_sotck_gty(item, item.qty);\n      // this.$forceUpdate();\n    },\n    add_item(item) {\n      if (!item.uom) {\n        item.uom = item.stock_uom;\n      }\n      const index = this.items.findIndex(\n        (el) => el.item_code === item.item_code && el.uom === item.uom\n      );\n      if (index === -1) {\n        const new_item = this.get_new_item(item);\n        this.items.unshift(new_item);\n        this.update_item_detail(new_item);\n      } else {\n        const cur_item = this.items[index];\n        this.update_items_details([cur_item]);\n        if (!cur_item.has_batch_no) {\n          cur_item.qty += item.qty;\n          this.calc_sotck_gty(cur_item, cur_item.qty);\n        } else {\n          if (\n            cur_item.stock_qty < cur_item.actual_batch_qty ||\n            !cur_item.batch_no\n          ) {\n            cur_item.qty += item.qty;\n            this.calc_sotck_gty(cur_item, cur_item.qty);\n          } else {\n            const new_item = this.get_new_item(cur_item);\n            new_item.batch_no = "";\n            new_item.batch_no_expiry_date = "";\n            new_item.actual_batch_qty = "";\n            new_item.qty = item.qty || 1;\n            this.items.unshift(new_item);\n          }\n        }\n      }\n    },\n    get_new_item(item) {\n      const new_item = { ...item };\n      if (!item.qty) {\n        item.qty = 1;\n      }\n      new_item.stock_qty = item.qty;\n      new_item.discount_amount = 0;\n      new_item.discount_percentage = 0;\n      new_item.discount_amount_per_item = 0;\n      new_item.price_list_rate = item.rate;\n      new_item.qty = item.qty;\n      new_item.uom = item.uom ? item.uom : item.stock_uom;\n      new_item.actual_batch_qty = "";\n      new_item.conversion_factor = 1;\n      new_item.item_id = Date.now();\n      if (new_item.has_batch_no || new_item.has_serial_no) {\n        this.expanded.push(new_item);\n      }\n      return new_item;\n    },\n    cancel_invoice() {\n      const doc = this.get_invoice_doc();\n      if (doc.name && this.pos_profile.posa_allow_delete) {\n        frappe.call({\n          method: "posawesome.posawesome.api.posapp.delete_invoice",\n          args: { invoice: doc.name },\n          async: true,\n          callback: function (r) {\n            if (r.message) {\n              evntBus.$emit("show_mesage", {\n                text: r.message,\n                color: "warning",\n              });\n            }\n          },\n        });\n      }\n      this.items = [];\n      this.customer = this.pos_profile.customer;\n      this.invoice_doc = "";\n      this.discount_amount = 0;\n    },\n    new_invoice(data = {}) {\n      this.expanded = [];\n      const doc = this.get_invoice_doc();\n      if (doc.name) {\n        this.update_invoice(doc);\n      } else {\n        if (doc.items.length) {\n          this.save_draft_invoice(doc);\n        }\n      }\n      if (!data.name) {\n        this.items = [];\n        this.customer = this.pos_profile.customer;\n        this.invoice_doc = "";\n        this.discount_amount = 0;\n      } else {\n        this.invoice_doc = data;\n        this.items = data.items;\n        let cont = 0;\n        this.items.forEach((item) => {\n          cont++;\n          item.item_id = Date.now() + cont;\n        });\n        this.update_items_details(this.items);\n        this.customer = data.customer;\n        this.discount_amount = data.discount_amount;\n        this.items.forEach((item) => {\n          if (item.serial_no) {\n            item.serial_no_selected = [];\n            const serial_list = item.serial_no.split("\\n");\n            serial_list.forEach((element) => {\n              if (element.length) {\n                item.serial_no_selected.push(element);\n              }\n            });\n            item.serial_no_selected_count = item.serial_no_selected.length;\n          }\n        });\n      }\n    },\n    save_draft_invoice() {\n      const vm = this;\n      const doc = this.get_invoice_doc();\n      frappe.call({\n        method: "posawesome.posawesome.api.posapp.save_draft_invoice",\n        args: { data: doc },\n        async: false,\n        callback: function (r) {\n          if (r.message) {\n            vm.invoice_doc = r.message;\n          }\n        },\n      });\n      return this.invoice_doc;\n    },\n    get_invoice_doc() {\n      let doc = {};\n      if (this.invoice_doc.name) {\n        doc = { ...this.invoice_doc };\n      }\n      doc.doctype = "Sales Invoice";\n      doc.is_pos = 1;\n      doc.company = doc.company || this.pos_profile.company;\n      doc.pos_profile = doc.pos_profile || this.pos_profile.name;\n      doc.currency = doc.currency || this.pos_profile.currency;\n      doc.naming_series = doc.naming_series || this.pos_profile.naming_series;\n      doc.customer = this.customer;\n      doc.items = this.get_invoice_items();\n      doc.total = this.subtotal;\n      doc.discount_amount = flt(this.discount_amount);\n      doc.posa_pos_opening_shift = this.pos_opening_shift.name;\n      doc.payments = this.get_payments();\n      doc.taxes = [];\n      return doc;\n    },\n    get_invoice_items() {\n      const items_list = [];\n      this.items.forEach((item) => {\n        items_list.push({\n          item_code: item.item_code,\n          qty: item.qty,\n          rate: item.rate,\n          uom: item.uom,\n          conversion_factor: item.conversion_factor,\n          serial_no: item.serial_no,\n          discount_percentage: item.discount_percentage,\n          discount_amount: item.discount_amount,\n          batch_no: item.batch_no,\n        });\n      });\n      return items_list;\n    },\n    get_payments() {\n      const payments = [];\n      this.pos_profile.payments.forEach((payment) => {\n        payments.push({\n          amount: 0,\n          mode_of_payment: payment.mode_of_payment,\n          default: payment.default,\n          account: "",\n        });\n      });\n      return payments;\n    },\n    update_invoice(doc) {\n      const vm = this;\n      frappe.call({\n        method: "posawesome.posawesome.api.posapp.update_invoice",\n        args: {\n          data: doc,\n        },\n        async: false,\n        callback: function (r) {\n          if (r.message) {\n            vm.invoice_doc = r.message;\n          }\n        },\n      });\n      return this.invoice_doc;\n    },\n    proces_invoice() {\n      const doc = this.get_invoice_doc();\n      if (doc.name) {\n        return this.update_invoice(doc);\n      } else {\n        return this.save_draft_invoice(doc);\n      }\n    },\n    show_payment() {\n      if (!this.customer) {\n        evntBus.$emit("show_mesage", {\n          text: `There is no Customer !`,\n          color: "error",\n        });\n        return;\n      }\n      if (!this.items.length) {\n        evntBus.$emit("show_mesage", {\n          text: `There is no Items !`,\n          color: "error",\n        });\n        return;\n      }\n      if (!this.validate_items()) {\n        return\n      }\n      evntBus.$emit("show_payment", "true");\n      const invoice_doc = this.proces_invoice();\n      invoice_doc.customer_info = this.customer_info;\n      evntBus.$emit("send_invoice_doc_payment", invoice_doc);\n    },\n    validate_items() {\n      let value = true\n      this.items.forEach(item => {\n        if (this.pos_profile.update_stock) {\n          if (item.stock_qty > item.actual_qty) {\n            evntBus.$emit("show_mesage", {\n              text: `The existing quantity of item ${item.item_name} is not enough`,\n              color: "error",\n            });\n            value = false\n          }\n        }\n        if (item.has_serial_no) {\n          if (!item.serial_no_selected || item.stock_qty != item.serial_no_selected.length) {\n            evntBus.$emit("show_mesage", {\n              text: `Selcted serial numbers of item ${item.item_name} is incorrect`,\n              color: "error",\n            });\n            vlaue = false\n          }\n        }\n        if (item.has_batch_no) {\n          if (item.stock_qty > item.actual_batch_qty) {\n            evntBus.$emit("show_mesage", {\n              text: `The existing batch quantity of item ${item.item_name} is not enough`,\n              color: "error",\n            });\n            value = false\n          }\n        }\n      })\n      return vlaue\n    },\n    get_draft_invoices() {\n      const vm = this;\n      frappe.call({\n        method: "posawesome.posawesome.api.posapp.get_draft_invoices",\n        args: {\n          pos_opening_shift: this.pos_opening_shift.name,\n        },\n        async: false,\n        callback: function (r) {\n          if (r.message) {\n            evntBus.$emit("open_drafts", r.message);\n          }\n        },\n      });\n    },\n    close_payments() {\n      evntBus.$emit("show_payment", "false");\n    },\n    update_items_details(items) {\n      if (!items.length > 0) {\n        return;\n      }\n      const vm = this;\n      frappe.call({\n        method: "posawesome.posawesome.api.posapp.get_items_details",\n        args: {\n          pos_profile: vm.pos_profile,\n          items_data: items,\n        },\n        callback: function (r) {\n          if (r.message) {\n            items.forEach((item) => {\n              const updated_item = r.message.find(\n                (element) => element.item_id == item.item_id\n              );\n              item.actual_qty = updated_item.actual_qty;\n              item.serial_no_data = updated_item.serial_no_data;\n              item.batch_no_data = updated_item.batch_no_data;\n              item.item_uoms = updated_item.item_uoms;\n              item.has_batch_no = updated_item.has_batch_no;\n              item.has_serial_no = updated_item.has_serial_no;\n            });\n          }\n        },\n      });\n    },\n    update_item_detail(item) {\n      const vm = this;\n      frappe.call({\n        method: "posawesome.posawesome.api.posapp.get_item_detail",\n        args: {\n          doc: this.get_invoice_doc(),\n          data: {\n            item_code: item.item_code,\n            customer: this.customer,\n            doctype: "Sales Invoice",\n            name: "New Sales Invoice 1",\n            company: this.pos_profile.company,\n            conversion_rate: 1,\n            qty: item.qty,\n            price_list_rate: item.price_list_rate,\n            child_docname: "New Sales Invoice Item 1",\n            cost_center: this.pos_profile.cost_center,\n            currency: this.pos_profile.currency,\n            // plc_conversion_rate: 1,\n            pos_profile: this.pos_profile.name,\n            price_list: this.pos_profile.selling_price_list,\n            uom: item.uom,\n            tax_category: "",\n            transaction_type: "selling",\n            update_stock: this.pos_profile.update_stock,\n          },\n        },\n        callback: function (r) {\n          if (r.message) {\n            const data = r.message;\n            if (data.has_pricing_rule) {\n              item.discount_amount_on_rate = data.discount_amount_on_rate;\n              item.discount_percentage = data.discount_percentage;\n              item.discount_percentage_on_rate =\n                data.discount_percentage_on_rate;\n              item.discount_amount = data.discount_amount || 0;\n            }\n            item.price_list_rate = data.price_list_rate;\n            item.has_pricing_rule = data.has_pricing_rule;\n            item.last_purchase_rate = data.last_purchase_rate;\n            item.price_or_product_discount = data.price_or_product_discount;\n            item.pricing_rule_for = data.pricing_rule_for;\n            item.pricing_rules = data.pricing_rules;\n            item.projected_qty = data.projected_qty;\n            item.reserved_qty = data.reserved_qty;\n            item.conversion_factor = data.conversion_factor;\n            item.stock_qty = data.stock_qty;\n            item.stock_uom = data.stock_uom;\n            (item.has_serial_no = data.has_serial_no),\n              (item.has_batch_no = data.has_batch_no),\n              vm.calc_item_price(item);\n          }\n        },\n      });\n    },\n    fetch_customer_details() {\n      const vm = this;\n      if (this.customer) {\n        return new Promise((resolve) => {\n          frappe.db\n            .get_value("Customer", vm.customer, [\n              "email_id",\n              "mobile_no",\n              "image",\n              "loyalty_program",\n            ])\n            .then(({ message }) => {\n              const { loyalty_program } = message;\n              if (loyalty_program) {\n                frappe.call({\n                  method:\n                    "erpnext.accounts.doctype.loyalty_program.loyalty_program.get_loyalty_program_details_with_points",\n                  args: {\n                    customer: vm.customer,\n                    loyalty_program,\n                    silent: true,\n                  },\n                  callback: (r) => {\n                    const { loyalty_points, conversion_factor } = r.message;\n                    if (!r.exc) {\n                      vm.customer_info = {\n                        ...message,\n                        customer: vm.customer,\n                        loyalty_points,\n                        conversion_factor,\n                      };\n                      resolve();\n                    }\n                  },\n                });\n              } else {\n                vm.customer_info = { ...message, customer: vm.customer };\n                resolve();\n              }\n            });\n        });\n      } else {\n        return new Promise((resolve) => {\n          vm.customer_info = {};\n          resolve();\n        });\n      }\n    },\n    calc_prices(item, value, $event) {\n      if (event.target.id === "rate") {\n        item.discount_percentage = 0;\n        if (value < item.price_list_rate) {\n          item.discount_amount = (\n            flt(item.price_list_rate) - flt(value)\n          ).toFixed(2);\n        } else if (value < 0) {\n          item.rate = item.price_list_rate;\n          item.discount_amount = 0;\n        } else if (value > item.price_list_rate) {\n          item.discount_amount = 0;\n        }\n      } else if (event.target.id === "discount_amount") {\n        if (value < 0) {\n          item.discount_amount = 0;\n          item.discount_percentage = 0;\n        } else {\n          item.rate = flt(item.price_list_rate) - flt(value);\n          item.discount_percentage = 0;\n        }\n      } else if (event.target.id === "discount_percentage") {\n        if (value < 0) {\n          item.discount_amount = 0;\n          item.discount_percentage = 0;\n        } else {\n          item.rate = (\n            flt(item.price_list_rate) -\n            (flt(item.price_list_rate) * flt(value)) / 100\n          ).toFixed(2);\n          item.discount_amount = (\n            flt(item.price_list_rate) - flt(item.rate)\n          ).toFixed(2);\n        }\n      }\n    },\n    calc_item_price(item) {\n      if (!item.has_pricing_rule) {\n        if (item.price_list_rate) {\n          item.rate = item.price_list_rate;\n        }\n      }\n      if (item.discount_percentage) {\n        item.rate =\n          flt(item.price_list_rate) -\n          (flt(item.price_list_rate) * flt(item.discount_percentage)) / 100;\n        item.discount_amount = (\n          flt(item.price_list_rate) - flt(item.rate)\n        ).toFixed(2);\n      } else if (item.discount_amount) {\n        item.rate = (\n          flt(item.price_list_rate) - flt(item.discount_amount)\n        ).toFixed(2);\n      } else if (item.pricing_rule_for === "Rate") {\n        item.rate = item.price_list_rate;\n      }\n    },\n    calc_uom(item, value) {\n      const new_uom = item.item_uoms.find((element) => element.uom == value);\n      item.conversion_factor = new_uom.conversion_factor;\n      if (!item.has_pricing_rule) {\n        item.discount_amount = 0;\n        item.discount_percentage = 0;\n      }\n      this.update_item_detail(item);\n    },\n    calc_sotck_gty(item, value) {\n      item.stock_qty = item.conversion_factor * value;\n    },\n    set_serial_no(item) {\n      item.serial_no = "";\n      item.serial_no_selected.forEach((element) => {\n        item.serial_no += element + "\\n";\n      });\n      item.serial_no_selected_count = item.serial_no_selected.length;\n      if (item.serial_no_selected_count != item.stock_qty) {\n        evntBus.$emit("show_mesage", {\n          text: `Selected Serial No QTY is ${item.serial_no_selected_count} it should be ${item.stock_qty}`,\n          color: "warning",\n        });\n      }\n    },\n    set_batch_qty(item, value) {\n      const batch_no = item.batch_no_data.find(\n        (element) => element.batch_no == value\n      );\n      item.actual_batch_qty = batch_no.batch_qty;\n      item.batch_no_expiry_date = batch_no.expiry_date;\n    },\n    set_customer_info(field, value) {\n      const vm = this;\n      frappe.call({\n        method:\n          "erpnext.selling.page.point_of_sale.point_of_sale.set_customer_info",\n        args: {\n          fieldname: field,\n          customer: this.customer_info.customer,\n          value: value,\n        },\n        callback: (r) => {\n          if (!r.exc) {\n            vm.customer_info[field] = value;\n            evntBus.$emit("show_mesage", {\n              text: "Customer contact updated successfully.",\n              color: "success",\n            });\n            frappe.utils.play_sound("submit");\n          }\n        },\n      });\n    },\n  },\n  created() {\n    this.$nextTick(function () {});\n    evntBus.$on("register_pos_profile", (data) => {\n      this.pos_profile = data.pos_profile;\n      this.customer = data.pos_profile.customer;\n      this.pos_opening_shift = data.pos_opening_shift;\n    });\n    evntBus.$on("add_item", (item) => {\n      // this.expanded = []\n      this.add_item(item);\n    });\n    evntBus.$on("update_customer", (customer) => {\n      this.customer = customer;\n    });\n    evntBus.$on("new_invoice", () => {\n      this.invoice_doc = "";\n      this.cancel_invoice();\n    });\n    evntBus.$on("load_invoice", (data) => {\n      this.new_invoice(data);\n    });\n  },\n  mounted: function () {},\n  watch: {\n    customer() {\n      this.close_payments();\n      evntBus.$emit("set_customer", this.customer);\n      this.fetch_customer_details();\n    },\n    expanded(data_value) {\n      this.update_items_details(data_value);\n      if (data_value.length > 0) {\n        this.update_item_detail(data_value[0]);\n      }\n    },\n  },\n};\n<\/script>\n\n<style scoped>\n.border_line_bottom {\n  border-bottom: 1px solid lightgray;\n}\n</style>']},media:void 0})},l,"data-v-0552fcbb",!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],n=e.styles||(e.styles={}),o="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,i){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var s=o?i.media||"default":e,a=n[s]||(n[s]={ids:[],parts:[],element:void 0});if(!a.ids.includes(e)){var c=i.source,r=a.ids.length;if(a.ids.push(e),o&&(a.element=a.element||document.querySelector("style[data-group="+s+"]")),!a.element){var l=a.element=document.createElement("style");l.type="text/css",i.media&&l.setAttribute("media",i.media),o&&(l.setAttribute("data-group",s),l.setAttribute("data-next-index","0")),t.appendChild(l)}if(o&&(r=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",r+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join("\n");else{var m=document.createTextNode(c),d=a.element.childNodes;d[r]&&a.element.removeChild(d[r]),d.length?a.element.insertBefore(m,d[r]):a.element.appendChild(m)}}}}}),_={props:["dialog"],data:function(){return{dialog_data:{},companys:[],company:"",pos_profiles_data:[],pos_profiles:[],pos_profile:"",payments_method_data:[],payments_methods:[],payments_methods_headers:[{text:"Mode of Payment",align:"start",sortable:!1,value:"mode_of_payment"},{text:"Opening Amount",value:"amount",align:"center",sortable:!1}],itemsPerPage:100,max25chars:function(e){return e.length<=12||"Input too long!"},pagination:{},snack:!1,snackColor:"",snackText:""}},watch:{company:function(e){var t=this;this.pos_profiles=[],this.pos_profiles_data.forEach(function(n){n.company===e&&t.pos_profiles.push(n.name),t.pos_profiles.length?t.pos_profile=t.pos_profiles[0]:t.pos_profile=""})},pos_profile:function(e){var t=this;this.payments_methods=[],this.payments_method_data.forEach(function(n){n.parent===e&&t.payments_methods.push({mode_of_payment:n.mode_of_payment,amount:0})})}},methods:{close_opening_dialog:function(){e.$emit("close_opening_dialog")},get_opening_dialog_data:function(){var e=this;frappe.call({method:"posawesome.posawesome.api.posapp.get_opening_dialog_data",args:{},callback:function(t){t.message&&(t.message.companys.forEach(function(t){e.companys.push(t.name)}),e.company=e.companys[0],e.pos_profiles_data=t.message.pos_profiles_data,e.payments_method_data=t.message.payments_method)}})},submit_dialog:function(){if(this.payments_methods.length&&this.company&&this.pos_profile){var t=this;return frappe.call("posawesome.posawesome.api.posapp.create_opening_voucher",{pos_profile:this.pos_profile,company:this.company,balance_details:this.payments_methods}).then(function(n){n.message&&(e.$emit("register_pos_data",n.message),e.$emit("set_company",n.message.company),t.close_opening_dialog())})}},save:function(){},cancel:function(){},open:function(){},close:function(){}},created:function(){this.$nextTick(function(){this.get_opening_dialog_data()})}},u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline indigo--text"},[e._v("Create POS Opening Shift")])]),e._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-autocomplete",{attrs:{items:e.companys,label:"Company",required:""},model:{value:e.company,callback:function(t){e.company=t},expression:"company"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-autocomplete",{attrs:{items:e.pos_profiles,label:"POS Profile",required:""},model:{value:e.pos_profile,callback:function(t){e.pos_profile=t},expression:"pos_profile"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.payments_methods_headers,items:e.payments_methods,"item-key":"mode_of_payment","items-per-page":e.itemsPerPage,"hide-default-footer":""},scopedSlots:e._u([{key:"item.amount",fn:function(t){return[n("v-edit-dialog",{attrs:{"return-value":t.item.amount},on:{"update:returnValue":function(n){return e.$set(t.item,"amount",n)},"update:return-value":function(n){return e.$set(t.item,"amount",n)},save:e.save,cancel:e.cancel,open:e.open,close:e.close},scopedSlots:e._u([{key:"input",fn:function(){return[n("v-text-field",{attrs:{rules:[e.max25chars],label:"Edit","single-line":"",counter:"",type:"number"},model:{value:t.item.amount,callback:function(n){e.$set(t.item,"amount",n)},expression:"props.item.amount"}})]},proxy:!0}],null,!0)},[e._v("\n                      "+e._s(t.item.amount)+"\n                      ")])]}}])})]],2)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",dark:""},on:{click:e.submit_dialog}},[e._v("Submit")])],1)],1)],1)],1)};u._withStripped=!0;var p=function(e,t,n,o,i,s,a,c){var r=("function"==typeof n?n.options:n)||{};return r.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/OpeningDialog.vue",r.render||(r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._compiled=!0,i&&(r.functional=!0)),r._scopeId=o,r}({render:u,staticRenderFns:[]},0,_,void 0,!1),v={data:function(){return{loading:!1,pos_profile:"",invoice_doc:"",loyalty_amount:0}},methods:{back_to_invoice:function(){e.$emit("show_payment","false")},submit:function(){return this.total_payments<0?(e.$emit("show_mesage",{text:"Payments not correct",color:"error"}),void frappe.utils.play_sound("error")):!this.pos_profile.posa_allow_partial_payment&&this.total_payments<this.invoice_doc.grand_total?(e.$emit("show_mesage",{text:"The amount paid is not complete",color:"error"}),void frappe.utils.play_sound("error")):this.pos_profile.posa_allow_partial_payment&&!this.pos_profile.posa_allow_credit_sale&&0==this.total_payments?(e.$emit("show_mesage",{text:"Please enter the amount paid",color:"error"}),void frappe.utils.play_sound("error")):(this.submit_invoice(),e.$emit("new_invoice","false"),void this.back_to_invoice())},submit_invoice:function(){var t=this;frappe.call({method:"posawesome.posawesome.api.posapp.submit_invoice",args:{data:this.invoice_doc},async:!0,callback:function(n){n.message&&(t.load_print_page(),e.$emit("show_mesage",{text:"Invoice "+n.message.name+" Submited",color:"success"}),frappe.utils.play_sound("submit"))}})},set_full_amount:function(e){var t=this;this.invoice_doc.payments.forEach(function(n){n.amount=n.idx==e?t.invoice_doc.grand_total:0})},set_rest_amount:function(e){var t=this;this.invoice_doc.payments.forEach(function(n){n.idx==e&&0==n.amount&&t.diff_payment>0&&(n.amount=t.diff_payment)})},load_print_page:function(){var e=this.pos_profile.letter_head||0,t=frappe.urllib.get_base_url()+"/printview?doctype=Sales%20Invoice&name="+this.invoice_doc.name+"&format="+this.pos_profile.print_format+"&no_letterhead="+e,n=window.open(t,"Print");n.addEventListener("load",function(){n.print()},!0)}},computed:{total_payments:function(){var e=flt(this.invoice_doc.loyalty_amount);return this.invoice_doc.payments.forEach(function(t){e+=flt(t.amount)}),e.toFixed(2)},diff_payment:function(){return(this.invoice_doc.grand_total-this.total_payments).toFixed(2)},diff_lable:function(){return this.diff_payment<0?"Change":"To Be Paid"},available_pioints_amount:function(){var e=0;return this.invoice_doc.customer_info.loyalty_points&&(e=this.invoice_doc.customer_info.loyalty_points/this.invoice_doc.customer_info.conversion_factor),e}},created:function(){this.$nextTick(function(){var t=this;e.$on("send_invoice_doc_payment",function(e){t.invoice_doc=e,t.invoice_doc.payments.find(function(e){return 1==e.default}).amount=e.grand_total.toFixed(2),t.loyalty_amount=0}),e.$on("register_pos_profile",function(e){t.pos_profile=e.pos_profile})})},watch:{loyalty_amount:function(t){t>this.available_pioints_amount?(this.invoice_doc.loyalty_amount=0,this.invoice_doc.redeem_loyalty_points=0,this.invoice_doc.loyalty_points=0,e.$emit("show_mesage",{text:"Loyalty Amount can not be more then "+this.available_pioints_amount,color:"error"})):(this.invoice_doc.loyalty_amount=flt(this.loyalty_amount),this.invoice_doc.redeem_loyalty_points=1,this.invoice_doc.loyalty_points=flt(this.loyalty_amount)*this.invoice_doc.customer_info.conversion_factor)}}},f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"selection mx-auto grey lighten-5",staticStyle:{"max-height":"78vh",height:"78vh"}},[n("v-progress-linear",{attrs:{active:e.loading,indeterminate:e.loading,absolute:"",top:"",color:"deep-purple accent-4"}}),e._v(" "),n("div",{staticClass:" overflow-y-auto",staticStyle:{"max-height":"78vh"}},[e.invoice_doc?n("v-row",{staticClass:"px-1 py-0"},[n("v-col",{attrs:{cols:"7"}},[n("v-text-field",{attrs:{outlined:"",color:"indigo",label:"Paid Amount","background-color":"white","hide-details":"",type:"number",readonly:"",prefix:e.invoice_doc.currency,dense:""},model:{value:e.total_payments,callback:function(t){e.total_payments=t},expression:"total_payments"}})],1),e._v(" "),n("v-col",{attrs:{cols:"5"}},[n("v-text-field",{attrs:{outlined:"",color:"indigo",label:e.diff_lable,"background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency,dense:""},model:{value:e.diff_payment,callback:function(t){e.diff_payment=t},expression:"diff_payment"}})],1)],1):e._e(),e._v(" "),n("v-divider"),e._v(" "),e._l(e.invoice_doc.payments,function(t){return n("v-row",{key:t.name,staticClass:"pyments px-1 py-0"},[n("v-col",{attrs:{cols:"7"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:t.mode_of_payment,"background-color":"white","hide-details":"",type:"number",prefix:e.invoice_doc.currency},on:{focus:function(n){return e.set_rest_amount(t.idx)}},model:{value:t.amount,callback:function(n){e.$set(t,"amount",n)},expression:"payment.amount"}})],1),e._v(" "),n("v-col",{attrs:{cols:"5"}},[n("v-btn",{attrs:{block:"",color:"primary",dark:""},on:{click:function(n){return e.set_full_amount(t.idx)}}},[e._v(e._s(t.mode_of_payment))])],1)],1)}),e._v(" "),e.invoice_doc&&e.available_pioints_amount>0?n("v-row",{staticClass:"pyments px-1 py-0"},[n("v-col",{attrs:{cols:"7"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Redeem Loyalty Points","background-color":"white","hide-details":"",type:"number",prefix:e.invoice_doc.currency},model:{value:e.loyalty_amount,callback:function(t){e.loyalty_amount=t},expression:"loyalty_amount"}})],1),e._v(" "),n("v-col",{attrs:{cols:"5"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"You can redeem upto","background-color":"white","hide-details":"",type:"number",prefix:e.invoice_doc.currency,disabled:""},model:{value:e.available_pioints_amount,callback:function(t){e.available_pioints_amount=t},expression:"available_pioints_amount"}})],1)],1):e._e(),e._v(" "),n("v-divider"),e._v(" "),n("v-row",{staticClass:"px-1 py-0"},[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Net Total","background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency},model:{value:e.invoice_doc.net_total,callback:function(t){e.$set(e.invoice_doc,"net_total",t)},expression:"invoice_doc.net_total"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Tax and Charges","background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency},model:{value:e.invoice_doc.total_taxes_and_charges,callback:function(t){e.$set(e.invoice_doc,"total_taxes_and_charges",t)},expression:"invoice_doc.total_taxes_and_charges"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Totoal Amount","background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency},model:{value:e.invoice_doc.total,callback:function(t){e.$set(e.invoice_doc,"total",t)},expression:"invoice_doc.total"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Discount Amount","background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency},model:{value:e.invoice_doc.discount_amount,callback:function(t){e.$set(e.invoice_doc,"discount_amount",t)},expression:"invoice_doc.discount_amount"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",outlined:"",color:"indigo",label:"Grand Amount","background-color":"white","hide-details":"",type:"number",disabled:"",prefix:e.invoice_doc.currency},model:{value:e.invoice_doc.grand_total,callback:function(t){e.$set(e.invoice_doc,"grand_total",t)},expression:"invoice_doc.grand_total"}})],1)],1)],2)],1),e._v(" "),n("v-card",{staticClass:"cards mb-0 mt-3 py-0",staticStyle:{"max-height":"11vh",height:"11vh"},attrs:{flat:""}},[n("v-row",{attrs:{align:"start","no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"pa-1",attrs:{block:"",large:"",color:"warning",dark:""},on:{click:e.back_to_invoice}},[e._v("Back")])],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"mt-2",attrs:{block:"",large:"",color:"primary",dark:""},on:{click:e.submit}},[e._v("Submit Payments")])],1)],1)],1)],1)};f._withStripped=!0;var h=function(e,t,n,o,i,s,a,c){var r=("function"==typeof n?n.options:n)||{};return r.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/Payments.vue",r.render||(r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._compiled=!0,i&&(r.functional=!0)),r._scopeId=o,r}({render:f,staticRenderFns:[]},0,v,void 0,!1),g={data:function(){return{draftsDialog:!1,singleSelect:!0,selected:[],dialog_data:{},headers:[{text:"Customer",value:"customer",align:"start",sortable:!0},{text:"Date",align:"start",sortable:!0,value:"posting_date"},{text:"Invoice",value:"name",align:"start",sortable:!0},{text:"Amount",value:"grand_total",align:"start",sortable:!1}]}},watch:{},methods:{close_dialog:function(){this.draftsDialog=!1},submit_dialog:function(){this.selected.length>0&&(e.$emit("load_invoice",this.selected[0]),this.draftsDialog=!1)}},created:function(){var t=this;e.$on("open_drafts",function(e){t.draftsDialog=!0,t.dialog_data=e})}},y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{"max-width":"800px"},model:{value:e.draftsDialog,callback:function(t){e.draftsDialog=t},expression:"draftsDialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline indigo--text"},[e._v("Select Hold invoice")])]),e._v(" "),n("v-card-text",{staticClass:"pa-0"},[n("v-container",[n("v-row",[n("v-col",{staticClass:"pa-1",attrs:{cols:"12"}},[[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.dialog_data,"item-key":"name","single-select":e.singleSelect,"show-select":""},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})]],2)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",dark:""},on:{click:e.close_dialog}},[e._v("Close")]),e._v(" "),n("v-btn",{attrs:{color:"primary",dark:""},on:{click:e.submit_dialog}},[e._v("Select")])],1)],1)],1)],1)};y._withStripped=!0;var b=function(e,t,n,o,i,s,a,c){var r=("function"==typeof n?n.options:n)||{};return r.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/Drafts.vue",r.render||(r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._compiled=!0,i&&(r.functional=!0)),r._scopeId=o,r}({render:y,staticRenderFns:[]},0,g,void 0,!1),x={data:function(){return{closingDialog:!1,itemsPerPage:20,dialog_data:{},headers:[{text:"Mode of Payment",value:"mode_of_payment",align:"start",sortable:!0},{text:"Opening Amount",align:"end",sortable:!0,value:"opening_amount"},{text:"Closing Amount",value:"closing_amount",align:"end",sortable:!0},{text:"Expected Amount",value:"expected_amount",align:"end",sortable:!1},{text:"Difference",value:"difference",align:"end",sortable:!1}],max25chars:function(e){return e.length<=20||"Input too long!"},pagination:{}}},watch:{},methods:{close_dialog:function(){this.closingDialog=!1},submit_dialog:function(){e.$emit("submit_closing_pos",this.dialog_data),this.closingDialog=!1}},created:function(){var t=this;e.$on("open_ClosingDialog",function(e){t.closingDialog=!0,t.dialog_data=e})}},w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{"max-width":"900px"},model:{value:e.closingDialog,callback:function(t){e.closingDialog=t},expression:"closingDialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline indigo--text"},[e._v("Closing POS Shift")])]),e._v(" "),n("v-card-text",{staticClass:"pa-0"},[n("v-container",[n("v-row",[n("v-col",{staticClass:"pa-1",attrs:{cols:"12"}},[[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.dialog_data.payment_reconciliation,"item-key":"mode_of_payment","items-per-page":e.itemsPerPage,"hide-default-footer":""},scopedSlots:e._u([{key:"item.closing_amount",fn:function(t){return[n("v-edit-dialog",{attrs:{"return-value":t.item.closing_amount},on:{"update:returnValue":function(n){return e.$set(t.item,"closing_amount",n)},"update:return-value":function(n){return e.$set(t.item,"closing_amount",n)}},scopedSlots:e._u([{key:"input",fn:function(){return[n("v-text-field",{attrs:{rules:[e.max25chars],label:"Edit","single-line":"",counter:"",type:"number"},model:{value:t.item.closing_amount,callback:function(n){e.$set(t.item,"closing_amount",n)},expression:"props.item.closing_amount"}})]},proxy:!0}],null,!0)},[e._v("\n                      "+e._s(t.item.closing_amount)+"\n                      ")])]}},{key:"item.difference",fn:function(t){var n=t.item;return[e._v(e._s(n.difference=n.expected_amount-n.closing_amount))]}}])})]],2)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",dark:""},on:{click:e.close_dialog}},[e._v("Close")]),e._v(" "),n("v-btn",{attrs:{color:"primary",dark:""},on:{click:e.submit_dialog}},[e._v("Submit")])],1)],1)],1)],1)};w._withStripped=!0;var k=function(e,t,n,o,i,s,a,c){var r=("function"==typeof n?n.options:n)||{};return r.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/ClosingDialog.vue",r.render||(r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._compiled=!0,i&&(r.functional=!0)),r._scopeId=o,r}({render:w,staticRenderFns:[]},0,x,void 0,!1),C={data:function(){return{customerDialog:!1,customer_name:"",tax_id:"",mobile_no:"",email_id:""}},watch:{},methods:{close_dialog:function(){this.customerDialog=!1},submit_dialog:function(){var t=this;this.customer_name&&(frappe.call({method:"posawesome.posawesome.api.posapp.create_customer",args:{customer_name:this.customer_name,tax_id:this.tax_id,mobile_no:this.mobile_no,email_id:this.email_id},callback:function(n){!n.exc&&n.message.name&&(e.$emit("show_mesage",{text:"Customer contact created successfully.",color:"success"}),frappe.utils.play_sound("submit"),e.$emit("add_customer_to_list",t.customer_name),e.$emit("set_customer",t.customer_name),t.customer_name="",t.tax_id="",t.mobile_no="",t.email_id="")}}),this.customerDialog=!1)}},created:function(){var t=this;e.$on("open_new_customer",function(){t.customerDialog=!0})}},q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.customerDialog,callback:function(t){e.customerDialog=t},expression:"customerDialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline indigo--text"},[e._v("New Customer")])]),e._v(" "),n("v-card-text",{staticClass:"pa-0"},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{dense:"",color:"indigo",label:"Customer Name","background-color":"white","hide-details":""},model:{value:e.customer_name,callback:function(t){e.customer_name=t},expression:"customer_name"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",color:"indigo",label:"Tax ID","background-color":"white","hide-details":""},model:{value:e.tax_id,callback:function(t){e.tax_id=t},expression:"tax_id"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",color:"indigo",label:"Mobile No","background-color":"white","hide-details":""},model:{value:e.mobile_no,callback:function(t){e.mobile_no=t},expression:"mobile_no"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{dense:"",color:"indigo",label:"Email Id","background-color":"white","hide-details":""},model:{value:e.email_id,callback:function(t){e.email_id=t},expression:"email_id"}})],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",dark:""},on:{click:e.close_dialog}},[e._v("Close")]),e._v(" "),n("v-btn",{attrs:{color:"primary",dark:""},on:{click:e.submit_dialog}},[e._v("Submit")])],1)],1)],1)],1)};q._withStripped=!0;var S={data:function(){return{dialog:!1,pos_profile:"",pos_opening_shift:"",payment:!1}},components:{ItemsSelector:a,Invoice:d,OpeningDialog:p,Payments:h,Drafts:b,ClosingDialog:k,NewCustomer:function(e,t,n,o,i,s,a,c){var r=("function"==typeof n?n.options:n)||{};return r.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/NewCustomer.vue",r.render||(r.render=e.render,r.staticRenderFns=e.staticRenderFns,r._compiled=!0,i&&(r.functional=!0)),r._scopeId=o,r}({render:q,staticRenderFns:[]},0,C,void 0,!1)},methods:{check_opening_entry:function(){var t=this;return frappe.call("posawesome.posawesome.api.posapp.check_opening_shift",{user:frappe.session.user}).then(function(n){n.message?(t.pos_profile=n.message.pos_profile,t.pos_opening_shift=n.message.pos_opening_shift,e.$emit("register_pos_profile",n.message),e.$emit("set_company",n.message.company),console.log("LoadPosProfile")):t.create_opening_voucher()})},create_opening_voucher:function(){console.log("Opening Shift"),this.dialog=!0},get_closing_data:function(){return frappe.call("posawesome.posawesome.doctype.pos_closing_shift.pos_closing_shift.make_closing_shift_from_opening",{opening_shift:this.pos_opening_shift}).then(function(t){t.message?e.$emit("open_ClosingDialog",t.message):console.log(t)})},submit_closing_pos:function(t){var n=this;frappe.call("posawesome.posawesome.doctype.pos_closing_shift.pos_closing_shift.submit_closing_shift",{closing_shift:t}).then(function(t){t.message?(e.$emit("show_mesage",{text:"POS Shift Closed",color:"success"}),n.check_opening_entry()):console.log(t)})}},created:function(){this.$nextTick(function(){var t=this;this.check_opening_entry(),e.$on("close_opening_dialog",function(){t.dialog=!1}),e.$on("register_pos_data",function(n){t.pos_profile=n.pos_profile,t.pos_opening_shift=n.pos_opening_shift,e.$emit("register_pos_profile",n),console.log("LoadPosProfile")}),e.$on("show_payment",function(e){t.payment="true"===e}),e.$on("open_closing_dialog",function(){t.get_closing_data()}),e.$on("submit_closing_pos",function(e){t.submit_closing_pos(e)})})}},P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{fluid:""}},[n("ClosingDialog"),e._v(" "),n("Drafts"),e._v(" "),n("NewCustomer"),e._v(" "),e.dialog?n("OpeningDialog",{attrs:{dialog:e.dialog}}):e._e(),e._v(" "),n("v-row",{directives:[{name:"show",rawName:"v-show",value:!e.dialog,expression:"!dialog"}]},[n("v-col",{directives:[{name:"show",rawName:"v-show",value:!e.payment,expression:"!payment"}],staticClass:"pos pr-0",attrs:{xl:"5",lg:"6",md:"6",sm:"6",cols:"12"}},[n("ItemsSelector")],1),e._v(" "),n("v-col",{directives:[{name:"show",rawName:"v-show",value:e.payment,expression:"payment"}],staticClass:"pos pr-0",attrs:{xl:"5",lg:"6",md:"6",sm:"6",cols:"12"}},[n("Payments")],1),e._v(" "),n("v-col",{staticClass:"pos",attrs:{xl:"7",lg:"6",md:"6",sm:"6",cols:"12"}},[n("Invoice")],1)],1)],1)};P._withStripped=!0;var A={data:function(){return{page:"POS"}},components:{Navbar:o,POS:function(e,t,n,o,i,s,a,c){var r,l=("function"==typeof n?n.options:n)||{};if(l.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/components/pos/Pos.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,i&&(l.functional=!0)),l._scopeId=o,t&&(r=function(e){t.call(this,a(e))}),void 0!==r)if(l.functional){var m=l.render;l.render=function(e,t){return r.call(t),m(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,r):[r]}return l}({render:P,staticRenderFns:[]},function(e){e&&e("data-v-e91d0446_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",map:{version:3,sources:[],names:[],mappings:"",file:"Pos.vue"},media:void 0})},S,"data-v-e91d0446",!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],n=e.styles||(e.styles={}),o="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,i){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var s=o?i.media||"default":e,a=n[s]||(n[s]={ids:[],parts:[],element:void 0});if(!a.ids.includes(e)){var c=i.source,r=a.ids.length;if(a.ids.push(e),o&&(a.element=a.element||document.querySelector("style[data-group="+s+"]")),!a.element){var l=a.element=document.createElement("style");l.type="text/css",i.media&&l.setAttribute("media",i.media),o&&(l.setAttribute("data-group",s),l.setAttribute("data-next-index","0")),t.appendChild(l)}if(o&&(r=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",r+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join("\n");else{var m=document.createTextNode(c),d=a.element.childNodes;d[r]&&a.element.removeChild(d[r]),d.length?a.element.insertBefore(m,d[r]):a.element.appendChild(m)}}}}})},methods:{setPage:function(e){this.page=e},remove_frappe_nav:function(){this.$nextTick(function(){$(".page-head").remove(),$(".navbar.navbar-default.navbar-fixed-top").remove()})}},mounted:function(){this.remove_frappe_nav()},updated:function(){},created:function(){var e=this;setTimeout(function(){e.remove_frappe_nav()},700)}},T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{staticClass:"container1"},[n("v-main",[n("Navbar",{on:{changePage:function(t){return e.setPage(t)}}}),e._v(" "),n("keep-alive",[n(e.page,{tag:"component",staticClass:"mx-4 md-4"})],1)],1)],1)};T._withStripped=!0;var E=function(e,t,n,o,i,s,a,c){var r,l=("function"==typeof n?n.options:n)||{};if(l.__file="/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/Home.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,i&&(l.functional=!0)),l._scopeId=o,t&&(r=function(e){t.call(this,a(e))}),void 0!==r)if(l.functional){var m=l.render;l.render=function(e,t){return r.call(t),m(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,r):[r]}return l}({render:T,staticRenderFns:[]},function(e){e&&e("data-v-b905e188_0",{source:"\n.container1[data-v-b905e188] {\n  margin-top: 0px;\n}\n",map:{version:3,sources:["/home/frappe/bench-13/apps/posawesome/posawesome/public/js/posapp/Home.vue"],names:[],mappings:";AAiDA;EACA,eAAA;AACA",file:"Home.vue",sourcesContent:['<template>\n  <v-app class="container1">\n    <v-main>\n      <Navbar @changePage="setPage($event)"></Navbar>\n      <keep-alive>\n        <component v-bind:is="page" class="mx-4 md-4"></component>\n      </keep-alive>\n    </v-main>\n  </v-app>\n</template>\n\n<script>\nimport Navbar from "./components/Navbar.vue";\nimport POS from "./components/pos/Pos.vue";\n\nexport default {\n  data: function () {\n    return {\n      page: "POS",\n    };\n  },\n  components: {\n    Navbar,\n    POS,\n  },\n  methods: {\n    setPage(page) {\n      this.page = page;\n    },\n    remove_frappe_nav() {\n      this.$nextTick(function () {\n        $(".page-head").remove();\n        $(".navbar.navbar-default.navbar-fixed-top").remove();\n      });\n    },\n  },\n  mounted() {\n    this.remove_frappe_nav();\n  },\n  updated() {},\n  created: function () {\n    setTimeout(() => {\n      this.remove_frappe_nav();\n    }, 700);\n  },\n};\n<\/script>\n\n<style scoped>\n.container1 {\n  margin-top: 0px;\n}\n</style>']},media:void 0})},A,"data-v-b905e188",!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],n=e.styles||(e.styles={}),o="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,i){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var s=o?i.media||"default":e,a=n[s]||(n[s]={ids:[],parts:[],element:void 0});if(!a.ids.includes(e)){var c=i.source,r=a.ids.length;if(a.ids.push(e),o&&(a.element=a.element||document.querySelector("style[data-group="+s+"]")),!a.element){var l=a.element=document.createElement("style");l.type="text/css",i.media&&l.setAttribute("media",i.media),o&&(l.setAttribute("data-group",s),l.setAttribute("data-next-index","0")),t.appendChild(l)}if(o&&(r=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",r+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join("\n");else{var m=document.createTextNode(c),d=a.element.childNodes;d[r]&&a.element.removeChild(d[r]),d.length?a.element.insertBefore(m,d[r]):a.element.appendChild(m)}}}}});frappe.provide("frappe.PosApp"),frappe.PosApp.posapp=class{constructor(e){var t=e.parent;this.$parent=$(document),this.page=t.page,this.make_body()}make_body(){this.$el=this.$parent.find("#body_div"),this.vue=new Vue({vuetify:new Vuetify,el:this.$el[0],data:{},render:function(e){return e(E)}})}setup_header(){}}}();
//# sourceMappingURL=posapp.min.js.map
