{"version":3,"file":"posapp.min.js","sources":["../../../../apps/posawesome/posawesome/public/js/posapp/bus.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/Navbar.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/ItemsSelector.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/Customer.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/Invoice.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/OpeningDialog.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/Payments.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/Drafts.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/ClosingDialog.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/NewCustomer.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/components/pos/Pos.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/Home.vue?rollup-plugin-vue=script.js","../../../../apps/posawesome/posawesome/public/js/posapp/posapp.js"],"sourcesContent":["export const evntBus = new Vue();","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../bus\";\n\nexport default {\n  // components: {MyPopup},\n  data() {\n    return {\n      drawer: true,\n      mini: true,\n      item: 0,\n      items: [\n        { text: \"POS\", icon: \"mdi-point-of-sale\" },\n        { text: \"Dashboard\", icon: \"mdi-view-dashboard\" },\n      ],\n      page: \"\",\n      fav: true,\n      menu: false,\n      message: false,\n      hints: true,\n      menu_item: 0,\n      snack: false,\n      snackColor: \"\",\n      snackText: \"\",\n      company: \"POS Awesome\",\n      company_img: \"/assets/erpnext/images/erp-icon.svg\",\n    };\n  },\n  methods: {\n    changePage(key) {\n      this.$emit(\"changePage\", key);\n    },\n    go_to() {\n      frappe.set_route(\"workspace\", \"home\");\n      location.reload();\n    },\n    close_shift_dialog() {\n      evntBus.$emit(\"open_closing_dialog\");\n    },\n    show_mesage(data) {\n      this.snack = true;\n      this.snackColor = data.color;\n      this.snackText = data.text;\n    },\n  },\n  created: function () {\n    this.$nextTick(function () {\n      evntBus.$on(\"show_mesage\", (data) => {\n        this.show_mesage(data);\n      });\n      evntBus.$on(\"set_company\", (data) => {\n        this.company = data.name;\n        this.company_img = data.company_logo ? data.company_logo :this.company_img ;\n      });\n    });\n    \n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\n\nexport default {\n  // props: [\"pos_profile\"],\n  data: () => ({\n    pos_profile: \"\",\n    items_view: \"card\",\n    item_group: \"ALL\",\n    favourites_view: false,\n    loading: false,\n    items_group: [\"ALL\"],\n    items: [],\n    item_search_brcode: \"\",\n    search: \"\",\n    first_search: \"\",\n    itemsPerPage: 1000,\n    items_headers: [\n      { text: \"Name\", align: \"start\", sortable: true, value: \"item_name\" },\n      { text: \"Rate\", value: \"rate\", align: \"start\" },\n      { text: \"Currency\", value: \"currency\", align: \"start\" },\n      { text: \"Available QTY\", value: \"actual_qty\", align: \"start\" },\n      { text: \"UOM\", value: \"stock_uom\", align: \"start\" },\n    ],\n  }),\n\n  watch: {\n    filtred_items(data_value) {\n      this.update_items_details(data_value);\n    },\n  },\n\n  methods: {\n    get_items() {\n      if (!this.pos_profile) {\n        console.log(\"No POS Profile\");\n        return;\n      }\n      const vm = this;\n      this.loading = true;\n      if (localStorage.items_storage) {\n        vm.items = JSON.parse(localStorage.getItem(\"items_storage\"));\n        vm.loading = false;\n      }\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_items\",\n        args: { pos_profile: vm.pos_profile },\n        callback: function (r) {\n          if (r.message) {\n            localStorage.setItem(\"items_storage\", \"\");\n            localStorage.setItem(\"items_storage\", JSON.stringify(r.message));\n            vm.$nextTick(() => {\n              console.log(\"loadItmes\");\n              vm.items = JSON.parse(localStorage.getItem(\"items_storage\"));\n              vm.loading = false;\n            });\n          }\n        },\n      });\n    },\n    get_items_groups() {\n      if (!this.pos_profile) {\n        console.log(\"No POS Profile\");\n        return;\n      }\n      if (this.pos_profile.item_groups.length > 0) {\n        this.pos_profile.item_groups.forEach((element) => {\n          if (element.item_group !== \"All Item Groups\") {\n            this.items_group.push(element.item_group);\n          }\n        });\n      } else {\n        const vm = this;\n        frappe.call({\n          method: \"posawesome.posawesome.api.posapp.get_items_groups\",\n          args: {},\n          callback: function (r) {\n            if (r.message) {\n              r.message.forEach((element) => {\n                vm.items_group.push(element.name);\n              });\n            }\n          },\n        });\n      }\n    },\n    add_item(item) {\n      evntBus.$emit(\"add_item\", item);\n    },\n    enter_event() {\n      if (!this.filtred_items.length || !this.first_search) {\n        return;\n      }\n      const qty = this.get_item_qty(this.first_search);\n      const new_item = { ...this.filtred_items[0] };\n      new_item.qty = flt(qty);\n      new_item.item_barcode.forEach((element) => {\n        if (this.search == element.barcode) {\n          new_item.uom = element.posa_uom;\n        }\n      });\n      this.add_item(new_item);\n      this.search = null;\n      this.first_search = null;\n    },\n    get_item_qty(first_search) {\n      let scal_qty = 1;\n      if (first_search.startsWith(\"221\")) {\n        let pesokg1 = first_search.substr(7, 5);\n        let pesokg;\n        if (pesokg1.startsWith(\"0000\")) {\n          pesokg = \"0.00\" + pesokg1.substr(4);\n        } else if (pesokg1.startsWith(\"000\")) {\n          pesokg = \"0.0\" + pesokg1.substr(3);\n        } else if (pesokg1.startsWith(\"00\")) {\n          pesokg = \"0.\" + pesokg1.substr(2);\n        } else if (pesokg1.startsWith(\"0\")) {\n          pesokg =\n            pesokg1.substr(1, 1) + \".\" + pesokg1.substr(2, pesokg1.length);\n        } else if (!pesokg1.startsWith(\"0\")) {\n          pesokg =\n            pesokg1.substr(0, 2) + \".\" + pesokg1.substr(2, pesokg1.length);\n        }\n        scal_qty = pesokg;\n      }\n      return scal_qty;\n    },\n    get_search(first_search) {\n      let search_term = \"\";\n      if (first_search && first_search.startsWith(\"221\")) {\n        search_term = first_search.substr(0, 7);\n      } else {\n        search_term = first_search;\n      }\n      return search_term;\n    },\n    esc_event() {\n      this.search = null;\n      this.first_search = null;\n    },\n    update_items_details(items) {\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_items_details\",\n        args: {\n          pos_profile: vm.pos_profile,\n          items_data: items,\n        },\n        callback: function (r) {\n          if (r.message) {\n            // console.log(r.message);\n            items.forEach((item) => {\n              const updated_item = r.message.find(\n                (element) => element.item_code == item.item_code\n              );\n              item.actual_qty = updated_item.actual_qty;\n              item.serial_no_data = updated_item.serial_no_data;\n              item.batch_no_data = updated_item.batch_no_data;\n              item.item_uoms = updated_item.item_uoms;\n            });\n          }\n        },\n      });\n    },\n    update_cur_items_details() {\n      this.update_items_details(this.filtred_items);\n    },\n    scan_barcoud() {\n      const vm = this;\n      onScan.attachTo(document, {\n        suffixKeyCodes: [],\n        onScan: function (sCode) {\n          if (!vm.pos_profile.posa_use_server_for_searching) {\n            vm.first_search = sCode;\n            if (vm.filtred_items.length == 0) {\n              evntBus.$emit(\"show_mesage\", {\n                text: `No Item has this barcode ${sCode}`,\n                color: \"error\",\n              });\n              frappe.utils.play_sound(\"error\");\n            } else {\n              vm.enter_event();\n            }\n          } else {\n            let search_item = \"\";\n            frappe.call({\n              method: \"posawesome.posawesome.api.posapp.get_items_from_barcode\",\n              args: {\n                selling_price_list: vm.pos_profile.selling_price_list,\n                currency: vm.pos_profile.currency,\n                barcode: vm.get_search(sCode),\n              },\n              async: false,\n              callback: function (r) {\n                if (r.message) {\n                  search_item = r.message;\n                }\n              },\n            });\n            if (!search_item) {\n              evntBus.$emit(\"show_mesage\", {\n                text: `No Item has this barcode ${sCode}`,\n                color: \"error\",\n              });\n              frappe.utils.play_sound(\"error\");\n            } else {\n              vm.first_search = sCode;\n              vm.item_search_brcode = search_item;\n              vm.enter_event();\n              vm.item_search_brcode = null;\n            }\n          }\n        },\n      });\n    },\n  },\n\n  computed: {\n    filtred_items() {\n      if (this.item_search_brcode) {\n        return [this.item_search_brcode];\n      }\n      this.search = this.get_search(this.first_search);\n      let filtred_list = [];\n      let filtred_group_list = [];\n      if (this.item_group != \"ALL\") {\n        filtred_group_list = this.items.filter((item) =>\n          item.item_group.toLowerCase().includes(this.item_group.toLowerCase())\n        );\n      } else {\n        filtred_group_list = this.items;\n      }\n      if (!this.search || this.search.length < 3) {\n        return (filtred_list = filtred_group_list.slice(0, 100));\n      } else if (this.search) {\n        filtred_list = filtred_group_list.filter((item) => {\n          let found = false;\n          for (let element of item.item_barcode) {\n            if (element.barcode == this.search) {\n              found = true;\n              break;\n            }\n          }\n          return found;\n        });\n        if (filtred_list.length == 0) {\n          filtred_list = filtred_group_list.filter((item) =>\n            item.item_name.toLowerCase().includes(this.search.toLowerCase())\n          );\n          if (filtred_list.length == 0) {\n            filtred_list = filtred_group_list.filter((item) =>\n              item.item_code.toLowerCase().includes(this.search.toLowerCase())\n            );\n          }\n        }\n      }\n      return filtred_list.slice(0, 100);\n    },\n  },\n\n  created: function () {\n    this.$nextTick(function () {});\n    evntBus.$on(\"register_pos_profile\", (data) => {\n      this.pos_profile = data.pos_profile;\n      this.get_items();\n      this.get_items_groups();\n    });\n    evntBus.$on(\"update_cur_items_details\", () => {\n      this.update_cur_items_details();\n    });\n  },\n\n  mounted() {\n    this.scan_barcoud();\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nexport default {\n  data: () => ({\n    pos_profile: \"\",\n    customers: [],\n    customer: \"\",\n  }),\n\n  methods: {\n    get_customer_names() {\n      const vm = this;\n      if (localStorage.customer_storage) {\n        vm.customers = JSON.parse(localStorage.getItem(\"customer_storage\"));\n      }\n\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_customer_names\",\n        args: {},\n        callback: function (r) {\n          if (r.message) {\n            localStorage.setItem(\"customer_storage\", \"\");\n            localStorage.setItem(\"customer_storage\", JSON.stringify(r.message));\n            vm.$nextTick(() => {\n              console.log(\"loadCustomers\");\n              vm.customers = JSON.parse(\n                localStorage.getItem(\"customer_storage\")\n              );\n            });\n          }\n        },\n      });\n    },\n    new_customer() {\n      evntBus.$emit(\"open_new_customer\");\n    },\n    customFilter (item, queryText, itemText) {\n        const textOne = item.name.toLowerCase()\n        const textTwo = item.tax_id ? item.tax_id.toLowerCase() : \"\"\n        const textThree = item.email_id ? item.email_id.toLowerCase() : \"\"\n        const textFour = item.mobile_no ? item.mobile_no.toLowerCase() : \"\"\n        const searchText = queryText.toLowerCase()\n\n        return textOne.indexOf(searchText) > -1 ||\n          textTwo.indexOf(searchText) > -1 || \n          textThree.indexOf(searchText) > -1 || \n          textFour.indexOf(searchText) > -1\n\n      },\n  },\n  computed: {},\n\n  created: function () {\n    this.$nextTick(function () {\n      evntBus.$on(\"register_pos_profile\", (pos_profile) => {\n        this.pos_profile = pos_profile;\n        this.get_customer_names();\n      });\n      evntBus.$on(\"set_customer\", (customer) => {\n        this.customer = customer;\n      });\n      evntBus.$on(\"add_customer_to_list\", (customer) => {\n        this.customers.push(customer);\n      });\n    });\n  },\n\n  watch: {\n    customer() {\n      evntBus.$emit(\"update_customer\", this.customer);\n    },\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nimport Customer from \"./Customer.vue\";\nexport default {\n  // props: [\"pos_profile\"],\n  data() {\n    return {\n      pos_profile: \"\",\n      pos_opening_shift: \"\",\n      invoice_doc: \"\",\n      customer: \"\",\n      customer_info: \"\",\n      discount_amount: 0,\n      total_tax: 0,\n      total: 0,\n      items: [],\n      itemsPerPage: 1000,\n      expanded: [],\n      singleExpand: true,\n      items_headers: [\n        {\n          text: \"Name\",\n          align: \"start\",\n          sortable: true,\n          value: \"item_name\",\n        },\n        { text: \"QTY\", value: \"qty\", align: \"center\" },\n        { text: \"UOM\", value: \"uom\", align: \"center\" },\n        { text: \"Rate\", value: \"rate\", align: \"center\" },\n        { text: \"Amount\", value: \"amount\", align: \"center\" },\n      ],\n    };\n  },\n  components: {\n    Customer,\n  },\n  computed: {\n    total_qty() {\n      this.close_payments();\n      let qty = 0;\n      this.items.forEach((item) => {\n        qty += item.qty;\n      });\n      return flt(qty).toFixed(2);\n    },\n    subtotal() {\n      this.close_payments();\n      let sum = 0;\n      this.items.forEach((item) => {\n        sum += item.qty * item.rate;\n      });\n      sum -= flt(this.discount_amount);\n      return flt(sum).toFixed(2);\n    },\n    total_items_discount_amount() {\n      let sum = 0;\n      this.items.forEach((item) => {\n        sum += item.qty * item.discount_amount;\n      });\n      return flt(sum).toFixed(2);\n    },\n  },\n  methods: {\n    remove_item(item) {\n      const index = this.items.findIndex((el) => el === item);\n      this.items.splice(index, 1);\n      const idx = this.expanded.findIndex((el) => el === item);\n      if (idx >= 0) {\n        this.expanded.splice(idx, 1);\n      }\n    },\n    add_one(item) {\n      item.qty++;\n      this.calc_sotck_gty(item, item.qty);\n      // this.$forceUpdate();\n    },\n    subtract_one(item) {\n      item.qty--;\n      if (item.qty <= 0) {\n        this.remove_item(item);\n      }\n      this.calc_sotck_gty(item, item.qty);\n      // this.$forceUpdate();\n    },\n    add_item(item) {\n      if (!item.uom) {\n        item.uom = item.stock_uom;\n      }\n      const index = this.items.findIndex(\n        (el) => el.item_code === item.item_code && el.uom === item.uom\n      );\n      if (index === -1) {\n        const new_item = this.get_new_item(item);\n        this.items.unshift(new_item);\n        this.update_item_detail(new_item);\n      } else {\n        const cur_item = this.items[index];\n        this.update_items_details([cur_item]);\n        if (!cur_item.has_batch_no) {\n          cur_item.qty += item.qty;\n          this.calc_sotck_gty(cur_item, cur_item.qty);\n        } else {\n          if (\n            cur_item.stock_qty < cur_item.actual_batch_qty ||\n            !cur_item.batch_no\n          ) {\n            cur_item.qty += item.qty;\n            this.calc_sotck_gty(cur_item, cur_item.qty);\n          } else {\n            const new_item = this.get_new_item(cur_item);\n            new_item.batch_no = \"\";\n            new_item.batch_no_expiry_date = \"\";\n            new_item.actual_batch_qty = \"\";\n            new_item.qty = item.qty || 1;\n            this.items.unshift(new_item);\n          }\n        }\n      }\n    },\n    get_new_item(item) {\n      const new_item = { ...item };\n      if (!item.qty) {\n        item.qty = 1;\n      }\n      new_item.stock_qty = item.qty;\n      new_item.discount_amount = 0;\n      new_item.discount_percentage = 0;\n      new_item.discount_amount_per_item = 0;\n      new_item.price_list_rate = item.rate;\n      new_item.qty = item.qty;\n      new_item.uom = item.uom ? item.uom : item.stock_uom;\n      new_item.actual_batch_qty = \"\";\n      new_item.conversion_factor = 1;\n      new_item.item_id = Date.now();\n      if (new_item.has_batch_no || new_item.has_serial_no) {\n        this.expanded.push(new_item);\n      }\n      return new_item;\n    },\n    cancel_invoice() {\n      const doc = this.get_invoice_doc();\n      if (doc.name && this.pos_profile.posa_allow_delete) {\n        frappe.call({\n          method: \"posawesome.posawesome.api.posapp.delete_invoice\",\n          args: { invoice: doc.name },\n          async: true,\n          callback: function (r) {\n            if (r.message) {\n              evntBus.$emit(\"show_mesage\", {\n                text: r.message,\n                color: \"warning\",\n              });\n            }\n          },\n        });\n      }\n      this.items = [];\n      this.customer = this.pos_profile.customer;\n      this.invoice_doc = \"\";\n      this.discount_amount = 0;\n    },\n    new_invoice(data = {}) {\n      this.expanded = [];\n      const doc = this.get_invoice_doc();\n      if (doc.name) {\n        this.update_invoice(doc);\n      } else {\n        if (doc.items.length) {\n          this.save_draft_invoice(doc);\n        }\n      }\n      if (!data.name) {\n        this.items = [];\n        this.customer = this.pos_profile.customer;\n        this.invoice_doc = \"\";\n        this.discount_amount = 0;\n      } else {\n        this.invoice_doc = data;\n        this.items = data.items;\n        let cont = 0;\n        this.items.forEach((item) => {\n          cont++;\n          item.item_id = Date.now() + cont;\n        });\n        this.update_items_details(this.items);\n        this.customer = data.customer;\n        this.discount_amount = data.discount_amount;\n        this.items.forEach((item) => {\n          if (item.serial_no) {\n            item.serial_no_selected = [];\n            const serial_list = item.serial_no.split(\"\\n\");\n            serial_list.forEach((element) => {\n              if (element.length) {\n                item.serial_no_selected.push(element);\n              }\n            });\n            item.serial_no_selected_count = item.serial_no_selected.length;\n          }\n        });\n      }\n    },\n    save_draft_invoice() {\n      const vm = this;\n      const doc = this.get_invoice_doc();\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.save_draft_invoice\",\n        args: { data: doc },\n        async: false,\n        callback: function (r) {\n          if (r.message) {\n            vm.invoice_doc = r.message;\n          }\n        },\n      });\n      return this.invoice_doc;\n    },\n    get_invoice_doc() {\n      let doc = {};\n      if (this.invoice_doc.name) {\n        doc = { ...this.invoice_doc };\n      }\n      doc.doctype = \"Sales Invoice\";\n      doc.is_pos = 1;\n      doc.company = doc.company || this.pos_profile.company;\n      doc.pos_profile = doc.pos_profile || this.pos_profile.name;\n      doc.currency = doc.currency || this.pos_profile.currency;\n      doc.naming_series = doc.naming_series || this.pos_profile.naming_series;\n      doc.customer = this.customer;\n      doc.items = this.get_invoice_items();\n      doc.total = this.subtotal;\n      doc.discount_amount = flt(this.discount_amount);\n      doc.posa_pos_opening_shift = this.pos_opening_shift.name;\n      doc.payments = this.get_payments();\n      doc.taxes = [];\n      return doc;\n    },\n    get_invoice_items() {\n      const items_list = [];\n      this.items.forEach((item) => {\n        items_list.push({\n          item_code: item.item_code,\n          qty: item.qty,\n          rate: item.rate,\n          uom: item.uom,\n          conversion_factor: item.conversion_factor,\n          serial_no: item.serial_no,\n          discount_percentage: item.discount_percentage,\n          discount_amount: item.discount_amount,\n          batch_no: item.batch_no,\n        });\n      });\n      return items_list;\n    },\n    get_payments() {\n      const payments = [];\n      this.pos_profile.payments.forEach((payment) => {\n        payments.push({\n          amount: 0,\n          mode_of_payment: payment.mode_of_payment,\n          default: payment.default,\n          account: \"\",\n        });\n      });\n      return payments;\n    },\n    update_invoice(doc) {\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.update_invoice\",\n        args: {\n          data: doc,\n        },\n        async: false,\n        callback: function (r) {\n          if (r.message) {\n            vm.invoice_doc = r.message;\n          }\n        },\n      });\n      return this.invoice_doc;\n    },\n    proces_invoice() {\n      const doc = this.get_invoice_doc();\n      if (doc.name) {\n        return this.update_invoice(doc);\n      } else {\n        return this.save_draft_invoice(doc);\n      }\n    },\n    show_payment() {\n      if (!this.customer) {\n        evntBus.$emit(\"show_mesage\", {\n          text: `There is no Customer !`,\n          color: \"error\",\n        });\n        return;\n      }\n      if (!this.items.length) {\n        evntBus.$emit(\"show_mesage\", {\n          text: `There is no Items !`,\n          color: \"error\",\n        });\n        return;\n      }\n      if (!this.validate_items()) {\n        return\n      }\n      evntBus.$emit(\"show_payment\", \"true\");\n      const invoice_doc = this.proces_invoice();\n      invoice_doc.customer_info = this.customer_info;\n      evntBus.$emit(\"send_invoice_doc_payment\", invoice_doc);\n    },\n    validate_items() {\n      let value = true\n      this.items.forEach(item => {\n        if (this.pos_profile.update_stock) {\n          if (item.stock_qty > item.actual_qty) {\n            evntBus.$emit(\"show_mesage\", {\n              text: `The existing quantity of item ${item.item_name} is not enough`,\n              color: \"error\",\n            });\n            value = false\n          }\n        }\n        if (item.has_serial_no) {\n          if (!item.serial_no_selected || item.stock_qty != item.serial_no_selected.length) {\n            evntBus.$emit(\"show_mesage\", {\n              text: `Selcted serial numbers of item ${item.item_name} is incorrect`,\n              color: \"error\",\n            });\n            value = false\n          }\n        }\n        if (item.has_batch_no) {\n          if (item.stock_qty > item.actual_batch_qty) {\n            evntBus.$emit(\"show_mesage\", {\n              text: `The existing batch quantity of item ${item.item_name} is not enough`,\n              color: \"error\",\n            });\n            value = false\n          }\n        }\n      })\n      return value\n    },\n    get_draft_invoices() {\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_draft_invoices\",\n        args: {\n          pos_opening_shift: this.pos_opening_shift.name,\n        },\n        async: false,\n        callback: function (r) {\n          if (r.message) {\n            evntBus.$emit(\"open_drafts\", r.message);\n          }\n        },\n      });\n    },\n    close_payments() {\n      evntBus.$emit(\"show_payment\", \"false\");\n    },\n    update_items_details(items) {\n      if (!items.length > 0) {\n        return;\n      }\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_items_details\",\n        args: {\n          pos_profile: vm.pos_profile,\n          items_data: items,\n        },\n        callback: function (r) {\n          if (r.message) {\n            items.forEach((item) => {\n              const updated_item = r.message.find(\n                (element) => element.item_id == item.item_id\n              );\n              item.actual_qty = updated_item.actual_qty;\n              item.serial_no_data = updated_item.serial_no_data;\n              item.batch_no_data = updated_item.batch_no_data;\n              item.item_uoms = updated_item.item_uoms;\n              item.has_batch_no = updated_item.has_batch_no;\n              item.has_serial_no = updated_item.has_serial_no;\n            });\n          }\n        },\n      });\n    },\n    update_item_detail(item) {\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_item_detail\",\n        args: {\n          doc: this.get_invoice_doc(),\n          data: {\n            item_code: item.item_code,\n            customer: this.customer,\n            doctype: \"Sales Invoice\",\n            name: \"New Sales Invoice 1\",\n            company: this.pos_profile.company,\n            conversion_rate: 1,\n            qty: item.qty,\n            price_list_rate: item.price_list_rate,\n            child_docname: \"New Sales Invoice Item 1\",\n            cost_center: this.pos_profile.cost_center,\n            currency: this.pos_profile.currency,\n            // plc_conversion_rate: 1,\n            pos_profile: this.pos_profile.name,\n            price_list: this.pos_profile.selling_price_list,\n            uom: item.uom,\n            tax_category: \"\",\n            transaction_type: \"selling\",\n            update_stock: this.pos_profile.update_stock,\n          },\n        },\n        callback: function (r) {\n          if (r.message) {\n            const data = r.message;\n            if (data.has_pricing_rule) {\n              item.discount_amount_on_rate = data.discount_amount_on_rate;\n              item.discount_percentage = data.discount_percentage;\n              item.discount_percentage_on_rate =\n                data.discount_percentage_on_rate;\n              item.discount_amount = data.discount_amount || 0;\n            }\n            item.price_list_rate = data.price_list_rate;\n            item.has_pricing_rule = data.has_pricing_rule;\n            item.last_purchase_rate = data.last_purchase_rate;\n            item.price_or_product_discount = data.price_or_product_discount;\n            item.pricing_rule_for = data.pricing_rule_for;\n            item.pricing_rules = data.pricing_rules;\n            item.projected_qty = data.projected_qty;\n            item.reserved_qty = data.reserved_qty;\n            item.conversion_factor = data.conversion_factor;\n            item.stock_qty = data.stock_qty;\n            item.stock_uom = data.stock_uom;\n            (item.has_serial_no = data.has_serial_no),\n              (item.has_batch_no = data.has_batch_no),\n              vm.calc_item_price(item);\n          }\n        },\n      });\n    },\n    fetch_customer_details() {\n      const vm = this;\n      if (this.customer) {\n        return new Promise((resolve) => {\n          frappe.db\n            .get_value(\"Customer\", vm.customer, [\n              \"email_id\",\n              \"mobile_no\",\n              \"image\",\n              \"loyalty_program\",\n            ])\n            .then(({ message }) => {\n              const { loyalty_program } = message;\n              if (loyalty_program) {\n                frappe.call({\n                  method:\n                    \"erpnext.accounts.doctype.loyalty_program.loyalty_program.get_loyalty_program_details_with_points\",\n                  args: {\n                    customer: vm.customer,\n                    loyalty_program,\n                    silent: true,\n                  },\n                  callback: (r) => {\n                    const { loyalty_points, conversion_factor } = r.message;\n                    if (!r.exc) {\n                      vm.customer_info = {\n                        ...message,\n                        customer: vm.customer,\n                        loyalty_points,\n                        conversion_factor,\n                      };\n                      resolve();\n                    }\n                  },\n                });\n              } else {\n                vm.customer_info = { ...message, customer: vm.customer };\n                resolve();\n              }\n            });\n        });\n      } else {\n        return new Promise((resolve) => {\n          vm.customer_info = {};\n          resolve();\n        });\n      }\n    },\n    calc_prices(item, value, $event) {\n      if (event.target.id === \"rate\") {\n        item.discount_percentage = 0;\n        if (value < item.price_list_rate) {\n          item.discount_amount = (\n            flt(item.price_list_rate) - flt(value)\n          ).toFixed(2);\n        } else if (value < 0) {\n          item.rate = item.price_list_rate;\n          item.discount_amount = 0;\n        } else if (value > item.price_list_rate) {\n          item.discount_amount = 0;\n        }\n      } else if (event.target.id === \"discount_amount\") {\n        if (value < 0) {\n          item.discount_amount = 0;\n          item.discount_percentage = 0;\n        } else {\n          item.rate = flt(item.price_list_rate) - flt(value);\n          item.discount_percentage = 0;\n        }\n      } else if (event.target.id === \"discount_percentage\") {\n        if (value < 0) {\n          item.discount_amount = 0;\n          item.discount_percentage = 0;\n        } else {\n          item.rate = (\n            flt(item.price_list_rate) -\n            (flt(item.price_list_rate) * flt(value)) / 100\n          ).toFixed(2);\n          item.discount_amount = (\n            flt(item.price_list_rate) - flt(item.rate)\n          ).toFixed(2);\n        }\n      }\n    },\n    calc_item_price(item) {\n      if (!item.has_pricing_rule) {\n        if (item.price_list_rate) {\n          item.rate = item.price_list_rate;\n        }\n      }\n      if (item.discount_percentage) {\n        item.rate =\n          flt(item.price_list_rate) -\n          (flt(item.price_list_rate) * flt(item.discount_percentage)) / 100;\n        item.discount_amount = (\n          flt(item.price_list_rate) - flt(item.rate)\n        ).toFixed(2);\n      } else if (item.discount_amount) {\n        item.rate = (\n          flt(item.price_list_rate) - flt(item.discount_amount)\n        ).toFixed(2);\n      } else if (item.pricing_rule_for === \"Rate\") {\n        item.rate = item.price_list_rate;\n      }\n    },\n    calc_uom(item, value) {\n      const new_uom = item.item_uoms.find((element) => element.uom == value);\n      item.conversion_factor = new_uom.conversion_factor;\n      if (!item.has_pricing_rule) {\n        item.discount_amount = 0;\n        item.discount_percentage = 0;\n      }\n      this.update_item_detail(item);\n    },\n    calc_sotck_gty(item, value) {\n      item.stock_qty = item.conversion_factor * value;\n    },\n    set_serial_no(item) {\n      item.serial_no = \"\";\n      item.serial_no_selected.forEach((element) => {\n        item.serial_no += element + \"\\n\";\n      });\n      item.serial_no_selected_count = item.serial_no_selected.length;\n      if (item.serial_no_selected_count != item.stock_qty) {\n        evntBus.$emit(\"show_mesage\", {\n          text: `Selected Serial No QTY is ${item.serial_no_selected_count} it should be ${item.stock_qty}`,\n          color: \"warning\",\n        });\n      }\n    },\n    set_batch_qty(item, value) {\n      const batch_no = item.batch_no_data.find(\n        (element) => element.batch_no == value\n      );\n      item.actual_batch_qty = batch_no.batch_qty;\n      item.batch_no_expiry_date = batch_no.expiry_date;\n    },\n    set_customer_info(field, value) {\n      const vm = this;\n      frappe.call({\n        method:\n          \"erpnext.selling.page.point_of_sale.point_of_sale.set_customer_info\",\n        args: {\n          fieldname: field,\n          customer: this.customer_info.customer,\n          value: value,\n        },\n        callback: (r) => {\n          if (!r.exc) {\n            vm.customer_info[field] = value;\n            evntBus.$emit(\"show_mesage\", {\n              text: \"Customer contact updated successfully.\",\n              color: \"success\",\n            });\n            frappe.utils.play_sound(\"submit\");\n          }\n        },\n      });\n    },\n  },\n  created() {\n    this.$nextTick(function () {});\n    evntBus.$on(\"register_pos_profile\", (data) => {\n      this.pos_profile = data.pos_profile;\n      this.customer = data.pos_profile.customer;\n      this.pos_opening_shift = data.pos_opening_shift;\n    });\n    evntBus.$on(\"add_item\", (item) => {\n      // this.expanded = []\n      this.add_item(item);\n    });\n    evntBus.$on(\"update_customer\", (customer) => {\n      this.customer = customer;\n    });\n    evntBus.$on(\"new_invoice\", () => {\n      this.invoice_doc = \"\";\n      this.cancel_invoice();\n    });\n    evntBus.$on(\"load_invoice\", (data) => {\n      this.new_invoice(data);\n    });\n  },\n  mounted: function () {},\n  watch: {\n    customer() {\n      this.close_payments();\n      evntBus.$emit(\"set_customer\", this.customer);\n      this.fetch_customer_details();\n    },\n    expanded(data_value) {\n      this.update_items_details(data_value);\n      if (data_value.length > 0) {\n        this.update_item_detail(data_value[0]);\n      }\n    },\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nexport default {\n  props: [\"dialog\"],\n  data: () => ({\n    dialog_data: {},\n    companys: [],\n    company: \"\",\n    pos_profiles_data: [],\n    pos_profiles: [],\n    pos_profile: \"\",\n    payments_method_data: [],\n    payments_methods: [],\n    payments_methods_headers: [\n      {\n        text: \"Mode of Payment\",\n        align: \"start\",\n        sortable: false,\n        value: \"mode_of_payment\",\n      },\n      {\n        text: \"Opening Amount\",\n        value: \"amount\",\n        align: \"center\",\n        sortable: false,\n      },\n    ],\n    itemsPerPage: 100,\n    max25chars: (v) => v.length <= 12 || \"Input too long!\", // TODO : should validate as number\n    pagination: {},\n    snack: false, // TODO : need to remove\n    snackColor: \"\", // TODO : need to remove\n    snackText: \"\", // TODO : need to remove\n  }),\n  watch: {\n    company(val) {\n      this.pos_profiles = [];\n      this.pos_profiles_data.forEach((element) => {\n        if (element.company === val) {\n          this.pos_profiles.push(element.name);\n        }\n        if (this.pos_profiles.length) {\n          this.pos_profile = this.pos_profiles[0];\n        } else {\n          this.pos_profile = \"\";\n        }\n      });\n    },\n    pos_profile(val) {\n      this.payments_methods = [];\n      this.payments_method_data.forEach((element) => {\n        if (element.parent === val) {\n          this.payments_methods.push({\n            mode_of_payment: element.mode_of_payment,\n            amount: 0,\n          });\n        }\n      });\n    },\n  },\n  methods: {\n    close_opening_dialog() {\n      evntBus.$emit(\"close_opening_dialog\");\n    },\n    get_opening_dialog_data() {\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.get_opening_dialog_data\",\n        args: {},\n        callback: function (r) {\n          if (r.message) {\n            r.message.companys.forEach((element) => {\n              vm.companys.push(element.name);\n            });\n            vm.company = vm.companys[0];\n            vm.pos_profiles_data = r.message.pos_profiles_data;\n            vm.payments_method_data = r.message.payments_method;\n          }\n        },\n      });\n    },\n    submit_dialog() {\n      if (!this.payments_methods.length || !this.company || !this.pos_profile) {\n        return;\n      }\n      const vm = this;\n      return frappe\n        .call(\"posawesome.posawesome.api.posapp.create_opening_voucher\", {\n          pos_profile: this.pos_profile,\n          company: this.company,\n          balance_details: this.payments_methods,\n        })\n        .then((r) => {\n          if (r.message) {\n            evntBus.$emit(\"register_pos_data\", r.message);\n            evntBus.$emit(\"set_company\", r.message.company);\n            vm.close_opening_dialog();\n          }\n        });\n    },\n    save() {\n      // TODO : need to remove\n    },\n    cancel() {\n      // TODO : need to remove\n    },\n    open() {\n      // TODO : need to remove\n    },\n    close() {\n      // TODO : need to remove\n    },\n  },\n  created: function () {\n    this.$nextTick(function () {\n      this.get_opening_dialog_data();\n    });\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nexport default {\n  data: () => ({\n    loading: false,\n    pos_profile: \"\",\n    invoice_doc: \"\",\n    loyalty_amount: 0,\n  }),\n\n  methods: {\n    back_to_invoice() {\n      evntBus.$emit(\"show_payment\", \"false\");\n    },\n    submit() {\n      if (this.total_payments < 0) {\n        evntBus.$emit(\"show_mesage\", {\n          text: `Payments not correct`,\n          color: \"error\",\n        });\n        frappe.utils.play_sound(\"error\");\n        return;\n      }\n      if (!this.pos_profile.posa_allow_partial_payment  && this.total_payments < this.invoice_doc.grand_total) {\n        evntBus.$emit(\"show_mesage\", {\n          text: `The amount paid is not complete`,\n          color: \"error\",\n        });\n        frappe.utils.play_sound(\"error\");\n        return;\n      }\n      if (this.pos_profile.posa_allow_partial_payment && !this.pos_profile.posa_allow_credit_sale  && this.total_payments == 0) {\n        evntBus.$emit(\"show_mesage\", {\n          text: `Please enter the amount paid`,\n          color: \"error\",\n        });\n        frappe.utils.play_sound(\"error\");\n        return;\n      }\n      this.submit_invoice();\n      evntBus.$emit(\"new_invoice\", \"false\");\n      this.back_to_invoice();\n    },\n    submit_invoice() {\n      const vm = this;\n      frappe.call({\n        method: \"posawesome.posawesome.api.posapp.submit_invoice\",\n        args: {\n          data: this.invoice_doc,\n        },\n        async: true,\n        callback: function (r) {\n          if (r.message) {\n            vm.load_print_page();\n            evntBus.$emit(\"show_mesage\", {\n              text: `Invoice ${r.message.name} Submited`,\n              color: \"success\",\n            });\n            frappe.utils.play_sound(\"submit\");\n          }\n        },\n      });\n    },\n    set_full_amount(idx) {\n      this.invoice_doc.payments.forEach((payment) => {\n        payment.amount = payment.idx == idx ? this.invoice_doc.grand_total : 0;\n      });\n      // this.submit();\n    },\n    set_rest_amount(idx) {\n      this.invoice_doc.payments.forEach((payment) => {\n        if (payment.idx == idx && payment.amount == 0 && this.diff_payment > 0) {\n          payment.amount  = this.diff_payment;\n        }\n      });\n    },\n    load_print_page() {\n      const letter_head = this.pos_profile.letter_head || 0;\n      const url =\n        frappe.urllib.get_base_url() +\n        \"/printview?doctype=Sales%20Invoice&name=\" +\n        this.invoice_doc.name +\n        \"&format=\" +\n        this.pos_profile.print_format +\n        \"&no_letterhead=\" +\n        letter_head;\n\n      // TODO : need better way for printing\n      const printWindow = window.open(url, \"Print\");\n      printWindow.addEventListener(\n        \"load\",\n        function () {\n          printWindow.print();\n          // printWindow.close();\n          // NOTE : uncomoent this to auto closing printing window\n        },\n        true\n      );\n    },\n  },\n\n  computed: {\n    total_payments() {\n      let total = flt(this.invoice_doc.loyalty_amount);\n      this.invoice_doc.payments.forEach((payment) => {\n        total += flt(payment.amount);\n      });\n      return total.toFixed(2);\n    },\n    diff_payment() {\n      return (this.invoice_doc.grand_total - this.total_payments).toFixed(2);\n    },\n    diff_lable() {\n      let lable = this.diff_payment < 0 ? \"Change\" : \"To Be Paid\";\n      return lable;\n    },\n    available_pioints_amount() {\n      let amount = 0;\n      if (this.invoice_doc.customer_info.loyalty_points) {\n        amount =\n          this.invoice_doc.customer_info.loyalty_points /\n          this.invoice_doc.customer_info.conversion_factor;\n      }\n      return amount;\n    },\n  },\n\n  created: function () {\n    this.$nextTick(function () {\n      evntBus.$on(\"send_invoice_doc_payment\", (invoice_doc) => {\n        this.invoice_doc = invoice_doc;\n        const default_payment = this.invoice_doc.payments.find(\n          (payment) => payment.default == 1\n        );\n        default_payment.amount = invoice_doc.grand_total.toFixed(2);\n        this.loyalty_amount = 0;\n      });\n      evntBus.$on(\"register_pos_profile\", (data) => {\n        this.pos_profile = data.pos_profile;\n      });\n    });\n  },\n\n  watch: {\n    loyalty_amount(value) {\n      if (value > this.available_pioints_amount) {\n        this.invoice_doc.loyalty_amount = 0;\n        this.invoice_doc.redeem_loyalty_points = 0;\n        this.invoice_doc.loyalty_points = 0;\n        evntBus.$emit(\"show_mesage\", {\n          text: `Loyalty Amount can not be more then ${this.available_pioints_amount}`,\n          color: \"error\",\n        });\n      } else {\n        this.invoice_doc.loyalty_amount = flt(this.loyalty_amount);\n        this.invoice_doc.redeem_loyalty_points = 1;\n        this.invoice_doc.loyalty_points =\n          flt(this.loyalty_amount) *\n          this.invoice_doc.customer_info.conversion_factor;\n      }\n    },\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nexport default {\n  // props: [\"draftsDialog\"],\n  data: () => ({\n    draftsDialog: false,\n    singleSelect: true,\n    selected: [],\n    dialog_data: {},\n    headers: [\n      {\n        text: \"Customer\",\n        value: \"customer\",\n        align: \"start\",\n        sortable: true,\n      },\n      {\n        text: \"Date\",\n        align: \"start\",\n        sortable: true,\n        value: \"posting_date\",\n      },\n      {\n        text: \"Invoice\",\n        value: \"name\",\n        align: \"start\",\n        sortable: true,\n      },\n      {\n        text: \"Amount\",\n        value: \"grand_total\",\n        align: \"start\",\n        sortable: false,\n      },\n    ],\n  }),\n  watch: {},\n  methods: {\n    close_dialog() {\n      this.draftsDialog = false;\n    },\n\n    submit_dialog() {\n      if (this.selected.length > 0) {\n        evntBus.$emit(\"load_invoice\", this.selected[0]);\n        this.draftsDialog = false;\n      }\n    },\n  },\n  created: function () {\n    evntBus.$on(\"open_drafts\", (data) => {\n      this.draftsDialog = true;\n      this.dialog_data = data;\n    });\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nexport default {\n  data: () => ({\n    closingDialog: false,\n    itemsPerPage: 20,\n    dialog_data: {},\n    headers: [\n      {\n        text: \"Mode of Payment\",\n        value: \"mode_of_payment\",\n        align: \"start\",\n        sortable: true,\n      },\n      {\n        text: \"Opening Amount\",\n        align: \"end\",\n        sortable: true,\n        value: \"opening_amount\",\n      },\n      {\n        text: \"Closing Amount\",\n        value: \"closing_amount\",\n        align: \"end\",\n        sortable: true,\n      },\n      {\n        text: \"Expected Amount\",\n        value: \"expected_amount\",\n        align: \"end\",\n        sortable: false,\n      },\n      {\n        text: \"Difference\",\n        value: \"difference\",\n        align: \"end\",\n        sortable: false,\n      },\n    ],\n    max25chars: (v) => v.length <= 20 || \"Input too long!\", // TODO : should validate as number\n    pagination: {},\n  }),\n  watch: {},\n  methods: {\n    close_dialog() {\n      this.closingDialog = false;\n    },\n\n    submit_dialog() {\n      evntBus.$emit(\"submit_closing_pos\", this.dialog_data);\n      this.closingDialog = false;\n    },\n  },\n  created: function () {\n    evntBus.$on(\"open_ClosingDialog\", (data) => {\n      this.closingDialog = true;\n      this.dialog_data = data;\n    });\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nexport default {\n  // props: [\"draftsDialog\"],\n  data: () => ({\n    customerDialog: false,\n    customer_name: \"\",\n    tax_id: \"\",\n    mobile_no: \"\",\n    email_id: \"\",\n  }),\n  watch: {},\n  methods: {\n    close_dialog() {\n      this.customerDialog = false;\n    },\n\n    submit_dialog() {\n      if (this.customer_name) {\n        const vm = this;\n        frappe.call({\n          method: \"posawesome.posawesome.api.posapp.create_customer\",\n          args: {\n            customer_name: this.customer_name,\n            tax_id: this.tax_id,\n            mobile_no: this.mobile_no,\n            email_id: this.email_id,\n          },\n          callback: (r) => {\n            if (!r.exc && r.message.name) {\n              evntBus.$emit(\"show_mesage\", {\n                text: \"Customer contact created successfully.\",\n                color: \"success\",\n              });\n              frappe.utils.play_sound(\"submit\");\n              evntBus.$emit(\"add_customer_to_list\", this.customer_name);\n              evntBus.$emit(\"set_customer\", this.customer_name);\n              this.customer_name = \"\";\n              this.tax_id = \"\";\n              this.mobile_no = \"\";\n              this.email_id = \"\";\n            }\n          },\n        });\n        this.customerDialog = false;\n      }\n    },\n  },\n  created: function () {\n    evntBus.$on(\"open_new_customer\", () => {\n      this.customerDialog = true;\n    });\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { evntBus } from \"../../bus\";\nimport ItemsSelector from \"./ItemsSelector.vue\";\nimport Invoice from \"./Invoice.vue\";\nimport OpeningDialog from \"./OpeningDialog.vue\";\nimport Payments from \"./Payments.vue\";\nimport Drafts from \"./Drafts.vue\";\nimport ClosingDialog from \"./ClosingDialog.vue\";\nimport NewCustomer from \"./NewCustomer.vue\";\n\nexport default {\n  data: function () {\n    return {\n      dialog: false,\n      pos_profile: \"\",\n      pos_opening_shift: \"\",\n      payment: false,\n    };\n  },\n\n  components: {\n    ItemsSelector,\n    Invoice,\n    OpeningDialog,\n    Payments,\n    Drafts,\n    ClosingDialog,\n    NewCustomer,\n  },\n\n  methods: {\n    check_opening_entry() {\n      return frappe\n        .call(\"posawesome.posawesome.api.posapp.check_opening_shift\", {\n          user: frappe.session.user,\n        })\n        .then((r) => {\n          if (r.message) {\n            this.pos_profile = r.message.pos_profile;\n            this.pos_opening_shift = r.message.pos_opening_shift;\n            evntBus.$emit(\"register_pos_profile\", r.message);\n            evntBus.$emit(\"set_company\", r.message.company);\n            console.log(\"LoadPosProfile\");\n          } else {\n            this.create_opening_voucher();\n          }\n        });\n    },\n    create_opening_voucher() {\n      console.log(\"Opening Shift\");\n      this.dialog = true;\n    },\n     get_closing_data() {\n      return frappe\n        .call(\"posawesome.posawesome.doctype.pos_closing_shift.pos_closing_shift.make_closing_shift_from_opening\", {\n          opening_shift: this.pos_opening_shift,\n        })\n        .then((r) => {\n          if (r.message) {\n            evntBus.$emit(\"open_ClosingDialog\",r.message);\n          } else {\n            console.log(r)\n          }\n        });\n    },\n    submit_closing_pos(data){\n      frappe\n        .call(\"posawesome.posawesome.doctype.pos_closing_shift.pos_closing_shift.submit_closing_shift\", {\n          closing_shift: data,\n        })\n        .then((r) => {\n          if (r.message) {\n            evntBus.$emit(\"show_mesage\", {\n              text: `POS Shift Closed`,\n              color: \"success\",\n            });\n            this.check_opening_entry()\n          } else {\n            console.log(r)\n          }\n        });\n    },\n  },\n\n  created: function () {\n    this.$nextTick(function () {\n      this.check_opening_entry();\n      evntBus.$on(\"close_opening_dialog\", () => {\n        this.dialog = false;\n      });\n      evntBus.$on(\"register_pos_data\", (data) => {\n        this.pos_profile = data.pos_profile;\n        this.pos_opening_shift = data.pos_opening_shift;\n        evntBus.$emit(\"register_pos_profile\", data);\n        console.log(\"LoadPosProfile\");\n      });\n      evntBus.$on(\"show_payment\", (data) => {\n        this.payment = true ? data ===\"true\": false;\n        // evntBus.$emit(\"update_cur_items_details\");\n      })\n      evntBus.$on(\"open_closing_dialog\", () => {\n        this.get_closing_data()\n      })\n      evntBus.$on(\"submit_closing_pos\", (data) => {\n        this.submit_closing_pos(data)\n      })\n    });\n  },\n};\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Navbar from \"./components/Navbar.vue\";\nimport POS from \"./components/pos/Pos.vue\";\n\nexport default {\n  data: function () {\n    return {\n      page: \"POS\",\n    };\n  },\n  components: {\n    Navbar,\n    POS,\n  },\n  methods: {\n    setPage(page) {\n      this.page = page;\n    },\n    remove_frappe_nav() {\n      this.$nextTick(function () {\n        $(\".page-head\").remove();\n        $(\".navbar.navbar-default.navbar-fixed-top\").remove();\n      });\n    },\n  },\n  mounted() {\n    this.remove_frappe_nav();\n  },\n  updated() {},\n  created: function () {\n    setTimeout(() => {\n      this.remove_frappe_nav();\n    }, 700);\n  },\n};\n","import Home from './Home.vue';\n\nfrappe.provide('frappe.PosApp');\n\n\nfrappe.PosApp.posapp = class {\n        constructor({ parent }) {\n                this.$parent = $(document);\n                this.page = parent.page;\n                this.make_body();\n                \n        }\n        make_body() {\n                this.$el = this.$parent.find('#body_div');\n                this.vue = new Vue({\n                        vuetify: new Vuetify(),\n                        el: this.$el[0],\n                        data: {\n                        },\n                        render: h => h(Home),\n                });\n                \n        }       \n        setup_header() {\n                \n        }\n};"],"names":["const","evntBus","Vue","data","drawer","mini","item","items","text","icon","page","fav","menu","message","hints","menu_item","snack","snackColor","snackText","company","company_img","methods","changePage","key","this","$emit","go_to","frappe","set_route","location","reload","close_shift_dialog","show_mesage","color","created","$nextTick","$on","name","company_logo","pos_profile","items_view","item_group","favourites_view","loading","items_group","item_search_brcode","search","first_search","itemsPerPage","items_headers","align","sortable","value","watch","filtred_items","data_value","update_items_details","get_items","vm","localStorage","items_storage","JSON","parse","getItem","call","method","args","callback","r","setItem","stringify","console","log","get_items_groups","item_groups","length","forEach","element","push","add_item","enter_event","qty","get_item_qty","new_item","Object","flt","item_barcode","barcode","uom","posa_uom","let","scal_qty","startsWith","pesokg","pesokg1","substr","get_search","esc_event","items_data","updated_item","find","item_code","actual_qty","serial_no_data","batch_no_data","item_uoms","update_cur_items_details","scan_barcoud","onScan","attachTo","document","suffixKeyCodes","sCode","posa_use_server_for_searching","search_item","selling_price_list","currency","async","utils","play_sound","computed","filtred_list","filtred_group_list","filter","toLowerCase","includes","slice","found","item_name","mounted","customers","customer","get_customer_names","customer_storage","new_customer","customFilter","queryText","itemText","textOne","textTwo","tax_id","textThree","email_id","textFour","mobile_no","searchText","indexOf","pos_opening_shift","invoice_doc","customer_info","discount_amount","total_tax","total","expanded","singleExpand","components","total_qty","close_payments","toFixed","subtotal","sum","rate","total_items_discount_amount","remove_item","index","findIndex","el","splice","idx","add_one","calc_sotck_gty","subtract_one","stock_uom","get_new_item","unshift","update_item_detail","cur_item","has_batch_no","stock_qty","actual_batch_qty","batch_no","batch_no_expiry_date","discount_percentage","discount_amount_per_item","price_list_rate","conversion_factor","item_id","Date","now","has_serial_no","cancel_invoice","doc","get_invoice_doc","posa_allow_delete","invoice","new_invoice","update_invoice","save_draft_invoice","cont","serial_no","serial_no_selected","split","serial_no_selected_count","doctype","is_pos","naming_series","get_invoice_items","posa_pos_opening_shift","payments","get_payments","taxes","items_list","payment","amount","mode_of_payment","default","account","proces_invoice","show_payment","validate_items","update_stock","get_draft_invoices","conversion_rate","child_docname","cost_center","price_list","tax_category","transaction_type","has_pricing_rule","discount_amount_on_rate","discount_percentage_on_rate","last_purchase_rate","price_or_product_discount","pricing_rule_for","pricing_rules","projected_qty","reserved_qty","calc_item_price","fetch_customer_details","Promise","resolve","db","get_value","then","ref","loyalty_program","silent","exc","loyalty_points","calc_prices","$event","event","target","id","calc_uom","new_uom","set_serial_no","set_batch_qty","batch_qty","expiry_date","set_customer_info","field","fieldname","props","dialog_data","companys","pos_profiles_data","pos_profiles","payments_method_data","payments_methods","payments_methods_headers","max25chars","v","pagination","val","parent","close_opening_dialog","get_opening_dialog_data","payments_method","submit_dialog","balance_details","save","cancel","open","close","loyalty_amount","back_to_invoice","submit","total_payments","posa_allow_partial_payment","grand_total","posa_allow_credit_sale","submit_invoice","load_print_page","set_full_amount","set_rest_amount","diff_payment","letter_head","url","urllib","get_base_url","print_format","printWindow","window","addEventListener","print","diff_lable","available_pioints_amount","redeem_loyalty_points","draftsDialog","singleSelect","selected","headers","close_dialog","closingDialog","customerDialog","customer_name","dialog","ItemsSelector","Invoice","OpeningDialog","Payments","Drafts","ClosingDialog","check_opening_entry","user","session","create_opening_voucher","get_closing_data","opening_shift","submit_closing_pos","closing_shift","Navbar","setPage","remove_frappe_nav","$","remove","updated","setTimeout","provide","PosApp","posapp","[object Object]","$parent","make_body","$el","vue","vuetify","Vuetify","render","h","Home"],"mappings":"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"}